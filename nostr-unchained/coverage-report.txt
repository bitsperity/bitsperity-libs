
> nostr-unchained@0.1.0 test
> vitest


 DEV  v0.34.6 /home/sascha-laptop/bitsperity-libs/nostr-unchained

 ❯ src/crypto/__tests__/chacha20-poly1305.test.ts  (0 test)
stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Native Svelte Readable Store Contract
✅ DELIVERED: Native Svelte $conversation.messages syntax support

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Memory-bounded LRU Message History (1000 messages)
✅ DELIVERED: LRU memory management works perfectly

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Cross-Tab Sync Infrastructure (BroadcastChannel)
Cross-tab sync supported: [33mtrue[39m
✅ DELIVERED: Cross-tab sync infrastructure ready

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Performance Requirements (<100ms store updates)
✅ DELIVERED: Store update in 0.32ms (<100ms requirement)

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Encryption Performance Requirements > should handle varying message sizes efficiently
100B: Encrypt 0.48ms, Decrypt 0.72ms

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Encryption Performance Requirements > should handle varying message sizes efficiently
1KB: Encrypt 2.32ms, Decrypt 0.71ms

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ Real Nostr Event Publishing (needs Phase 5 crypto)
🔌 Umbrel relay is reachable...
❌ CANNOT DELIVER: Real event publishing because:
    1. No Event ID calculation (SHA256 of serialized event)
    2. No Event signing (secp256k1 private key needed)
    3. No proper event serialization
    4. No NIP-01 compliance validation

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ Real Event Subscription (needs Phase 4 network layer)
❌ CANNOT DELIVER: Real relay subscription because:
   1. No WebSocket relay management (Phase 4)
   2. No NIP-01 subscription filters
   3. No event validation and parsing
   4. No relay error handling

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ DM Encryption/Decryption (needs Phase 2+ integration)
❌ CANNOT DELIVER: DM encryption because:
   1. No NIP-44 encryption integration yet
   2. No gift wrap (NIP-59) implementation
   3. No key management for conversations

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store State Management with Mock Events
🎯 CORRECTLY TESTED: Store state management

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store Integration with Event Bus
🎯 CORRECTLY TESTED: Event bus integration

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store Memory Management under Load
🎯 CORRECTLY TESTED: Memory management under load

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 📋 Phase 3 Honest Assessment Summary > 📊 What we ACTUALLY delivered vs. what we CLAIMED

📋 HONEST PHASE 3 ASSESSMENT:

Claimed Deliverables:
   ✅ DMConversation Store: Native Svelte Readable
   ✅ Subscription Lifecycle: Automatic cleanup
   ❌ Cross-Tab Sync: Infrastructure only (no real testing)
   ✅ Memory Management: LRU 1000 messages perfect
   ⚠️ SSR Compatibility: Not tested yet
   ✅ Performance: <100ms updates achieved

Actual Capabilities:
   Store works perfectly with mock events
   Relay connection works but cannot publish valid events
   Missing Phase 4 (Network) and Phase 5 (Event Creation) integration
   Store is ready to receive real events when other phases complete

🎯 CONCLUSION: Phase 3 store system works perfectly
   but needs Phase 4+5 for real Nostr integration

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Encryption Performance Requirements > should handle varying message sizes efficiently
10KB: Encrypt 1.33ms, Decrypt 1.78ms

 ❯ src/__tests__/phase3/phase3-scope-validation.test.ts  (12 tests | 1 failed) 111ms
   ❯ src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Automatic Subscription Cleanup
     → expected 1 to be +0 // Object.is equality
stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Encryption Performance Requirements > should handle varying message sizes efficiently
100KB: Encrypt 1.70ms, Decrypt 1.24ms

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Throughput Performance > should achieve >10 operations/second for 1KB messages
Throughput: 949.08 operations/second

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Throughput Performance > should maintain performance under concurrent load
Concurrent average: 6.89ms, max: 7.54ms

 ❯ src/__tests__/nostr-unchained.test.ts  (18 tests | 2 failed) 168ms
   ❯ src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
     → expected 'temporary' to be 'nip07' // Object.is equality
   ❯ src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
     → expected 'temporary' to be 'nip07' // Object.is equality
stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize with default configuration
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize with custom configuration
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'e3801f35a21e87a405a6e74c953a8c48452af8c54d88a03493db6d9f907fbaf2'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize in <200ms
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Builder Pattern > should create instance with builder pattern
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'8346580781f6a0552eefa588a17029aa8f5b57b3403a50e837a30f30c3f18b29'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Builder Pattern > should chain builder methods fluently
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should fallback to temporary signer when NIP-07 not available
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should provide signer capabilities
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should emit initialization events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should dispose resources properly
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should handle multiple dispose calls gracefully
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should emit disposal events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should connect to Umbrel relay successfully
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'83a285782302c6375fdd5461372874140ed0d87497ce3527caeece21594c6f08'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'1c1b4e2c0d61031f349758fd18aaf03b0347ab7c60a6e3903c2fb1c16aa854eb'[39m
}

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Memory Efficiency > should not accumulate memory during repeated operations
Memory - Warmup: +332.88KB, Test: +-4798.84KB

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
Store 1 messages: [33m1[39m
Store 2 messages: [33m0[39m
⚠️ LIMITATION EXPOSED: Stores don't share state without proper integration

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE

 ❯ src/crypto/__tests__/nip44-compliance.test.ts  (0 test)
stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Memory Efficiency > should handle large messages without excessive memory usage
Large message (100KB): 44.34KB memory used

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Nonce Generation Performance > should generate nonces quickly and uniquely
Nonce generation: 44603 nonces/second

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Bundle Size Impact Testing > should load crypto module efficiently
Crypto module load time: 0.01ms

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Bundle Size Impact Testing > should not impact main bundle significantly
Non-crypto operation: baseline 0.13ms, with crypto 0.09ms

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should handle high-frequency real-time updates without performance degradation
✅ DEMONSTRATED: High-frequency updates handled efficiently

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should demonstrate WHY we need proper state synchronization

🔍 DEMONSTRATING THE REAL PROBLEM:
💬 Chat component messages: [33m1[39m
🔔 Notification component messages: [33m0[39m
💬 Chat unread count: [33m1[39m
🔔 Notification unread count: [33m0[39m

❌ PROBLEM: Different store instances don't share state!
🔧 SOLUTION NEEDED: Proper state synchronization mechanism

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should show a working solution with Event Bus coordination

🔧 DEMONSTRATING A WORKING SOLUTION:
📡 Event bus received message:added event

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should show a working solution with Event Bus coordination
✅ Event bus coordination demonstrated
💡 Next step: Implement proper store synchronization

stdout | src/__tests__/phase2-performance.test.ts > Phase 2: Crypto Performance Validation > Edge Case Performance > should handle maximum practical message sizes
1MB message: 4.94ms

 ✓ src/__tests__/phase2-performance.test.ts  (12 tests) 554ms
stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should expose store system through main API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'9c65e542cce8ae074c1e1f0590e7ecaf5c2e3f69a7661c8a181170af4c9ada48'[39m
}
✅ StoreManager accessible via client.storeManager
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should provide conversation stores via getConversation()
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'84970af06e0527ae33c30ef607ff9e51a1c78b8b40c78ad313cfe87d15ecf92e'[39m
}
📁 Created synchronized store for conversation: test-chat-api
✅ client.getConversation() working correctly
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should work with Svelte $conversation reactive syntax
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'56b30c168f602453ab8a74a35eb86973c5913b009ca83b36c2506f503dda7825'[39m
}
📁 Created synchronized store for conversation: svelte-test
✅ Svelte reactive subscription working
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'3812667673a270fcf80f616ed393d400e9740fc1989cd5eb97f7036a10a6446b'[39m
}

🎯 Testing real developer workflow...
1️⃣ Client created and initialized
📁 Created synchronized store for conversation: user-workflow-test
2️⃣ Conversation obtained via API
3️⃣ Subscribed to conversation updates
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 3812667673a270fc...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

 ✓ src/__tests__/config.test.ts  (14 tests) 12ms
stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

 ❯ src/__tests__/phase3/dm-conversation-store.test.ts  (28 tests | 3 failed) 68ms
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Svelte Readable Contract > should notify subscribers when state changes
     → expected 1 to be greater than or equal to 2
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Message Management > should handle duplicate messages correctly
     → expected 2 to be 1 // Object.is equality
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Lifecycle Management > should prevent operations on disposed store
     → expected [Function] to throw error including 'STORE_DISPOSED' but got 'Cannot add message to disposed store'
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Crypto-Enhanced Foundation Layer > should initialize with crypto support and Umbrel relay
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'bbf3ee7451b73b2ddb3a30dde958bcab9ddf47e3f2c8a8ddf4c743dd0df71a0d'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should connect to Umbrel relay successfully
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'c3626f08e6e2a25fd935bc94866e1f35df98038586ede86ab877f474ccf30ffb'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should fallback to default relays when Umbrel unavailable
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'9b829474b2c074a5479efdcd480368acb78a23194712f6eb965e131c9b6cb703'[39m
}

🎯 TESTING REAL RELAY ACCEPTANCE...
==========================================
📝 Sending message: "🔬 Relay Test 1752951051446 - Testing acceptance"
⏳ Waiting for relay response...
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 9b829474b2c074a5...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'8bb4d9a4d5449e185199630dbd949b7604f0aa9260a0a6b0c64b16abef8d8daf'[39m
}

🎯 Publishing REAL signed event...
===============================
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 8bb4d9a4d5449e18...

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📝 Created REAL signed event using NostrUnchained: "Hello from the integrated API!..."
   🔑 PubKey: c702d2eb95bac028...
   ✍️ Signature: 1a99a684011662c7...
   🆔 Event ID: e715c8a0b1d52aca...
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: e715c8a0b1d52acae99eb87428ca9315059317bb065d0bc96f826e1dc6640b55
   Content: "Hello from the integrated API!..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
❌ Relay connection error ws://invalid.umbrel.local:4848: Event { isTrusted: [36m[Getter][39m }

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🔌 Disconnected from relay: ws://invalid.umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE
🔌 Disconnected from relay: ws://offline.umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
❌ Relay connection error ws://offline.umbrel.local:4848: Event { isTrusted: [36m[Getter][39m }

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Event ACCEPTED by relay: e715c8a0b1d52acae99eb87428ca9315059317bb065d0bc96f826e1dc6640b55
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: user-workflow-test
4️⃣ REAL message sent and published to relay!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 3 lines matching cause stack trace ...[39m
    at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: Command failed: node /home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs
  node:internal/modules/cjs/loader:1148
    throw err;
    ^
  
  Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
      at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
      at Module._load (node:internal/modules/cjs/loader:986:27)
      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
      at node:internal/main/run_main_module:28:49 {
    code: 'MODULE_NOT_FOUND',
    requireStack: []
  }
  
  Node.js v20.16.0
  
  [90m    at genericNodeError (node:internal/errors:984:15)[39m
  [90m    at wrappedFn (node:internal/errors:538:14)[39m
  [90m    at checkExecSyncError (node:child_process:890:11)[39m
  [90m    at execSync (node:child_process:962:15)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:101:24[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/relay-response-test.test.ts:40:23
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m {
    status: [33m1[39m,
    signal: [1mnull[22m,
    output: [
      [1mnull[22m,
      [32m''[39m,
      [32m'node:internal/modules/cjs/loader:1148\n'[39m +
        [32m'  throw err;\n'[39m +
        [32m'  ^\n'[39m +
        [32m'\n'[39m +
        [32m"Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'\n"[39m +
        [32m'    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)\n'[39m +
        [32m'    at Module._load (node:internal/modules/cjs/loader:986:27)\n'[39m +
        [32m'    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)\n'[39m +
        [32m'    at node:internal/main/run_main_module:28:49 {\n'[39m +
        [32m"  code: 'MODULE_NOT_FOUND',\n"[39m +
        [32m'  requireStack: []\n'[39m +
        [32m'}\n'[39m +
        [32m'\n'[39m +
        [32m'Node.js v20.16.0\n'[39m
    ],
    pid: [33m4137047[39m,
    stdout: [32m''[39m,
    stderr: [32m'node:internal/modules/cjs/loader:1148\n'[39m +
      [32m'  throw err;\n'[39m +
      [32m'  ^\n'[39m +
      [32m'\n'[39m +
      [32m"Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'\n"[39m +
      [32m'    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)\n'[39m +
      [32m'    at Module._load (node:internal/modules/cjs/loader:986:27)\n'[39m +
      [32m'    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)\n'[39m +
      [32m'    at node:internal/main/run_main_module:28:49 {\n'[39m +
      [32m"  code: 'MODULE_NOT_FOUND',\n"[39m +
      [32m'  requireStack: []\n'[39m +
      [32m'}\n'[39m +
      [32m'\n'[39m +
      [32m'Node.js v20.16.0\n'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
❌ FAILED! Event was REJECTED by relay!
   Error: Error: Failed to create valid Nostr event
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'58a89af0834394b0ab45cf695c116418f469a6847455dfbd4807bca263289a24'[39m
}

🗨️ TESTING MULTIPLE EVENTS...
==============================

1/3: Sending "📨 Multi-test 1: 1752951051559..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 58a89af0834394b0...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
🌐 Connecting to 1 relays...

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should cleanup crypto resources on disposal
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Concurrent Operations > should handle multiple concurrent crypto operations
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Concurrent Operations > should handle multiple concurrent crypto operations
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📡 Connected to Umbrel relay for publish test

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should recover from crypto operation failures
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should recover from crypto operation failures
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📥 Received from Umbrel relay: [ [32m'EOSE'[39m, [32m'phase3-test-sub'[39m ]

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should handle Umbrel relay disconnections gracefully
🌐 Connecting to 2 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should handle Umbrel relay disconnections gracefully
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase2-integration.test.ts  (15 tests | 1 failed) 298ms
   ❯ src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
     → promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Complete developer workflow successful!
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
📝 Created REAL signed event using NostrUnchained: "🎉 REAL EVENT from NostrUnchained API! 17529510514..."
   🔑 PubKey: 8b714748f5832833...
   ✍️ Signature: 863744c2c6000c5b...
   🆔 Event ID: 156694ebd0fb9b9b...
📁 Created synchronized store for conversation: real-event-test
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 156694ebd0fb9b9b8e59c8eb77016af0b8146b36614c98ee0c0635b6b15c060b
   Content: "📨 Multi-test 1: 1752951051559..."
📤 Event sent to relay, waiting for response...
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EOSE
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/relay-response-test.test.ts:76:25
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
🔌 Disconnected from relay: ws://umbrel.local:4848
   ❌ REJECTED: Error: Failed to create valid Nostr event

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
✅ Event ACCEPTED by relay: 156694ebd0fb9b9b8e59c8eb77016af0b8146b36614c98ee0c0635b6b15c060b
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: real-event-test
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'9feafd1d4e8096383abe0d79dea2b907f0eba5212f41445a6811d4bb9971f176'[39m
}

🔍 DEMONSTRATING API DIFFERENCES:
=================================
1️⃣ Using sendMessage() (RECOMMENDED):
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 9feafd1d4e809638...

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'03c5f3cfbb00521a7c792dfcfabef0904ee4c4b835fb73090b80ef8bf17a2a59'[39m
}
📁 Created synchronized store for conversation: multi-chat-1
📁 Created synchronized store for conversation: multi-chat-2
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 03c5f3cfbb00521a...
🔌 Disconnected from relay: ws://umbrel.local:4848
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stderr | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 3 lines matching cause stack trace ...[39m
    at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: Command failed: node /home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs
  node:internal/modules/cjs/loader:1148
    throw err;
    ^
  
  Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
      at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
      at Module._load (node:internal/modules/cjs/loader:986:27)
      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
      at node:internal/main/run_main_module:28:49 {
    code: 'MODULE_NOT_FOUND',
    requireStack: []
  }
  
  Node.js v20.16.0
  
  [90m    at genericNodeError (node:internal/errors:984:15)[39m
  [90m    at wrappedFn (node:internal/errors:538:14)[39m
  [90m    at checkExecSyncError (node:child_process:890:11)[39m
  [90m    at execSync (node:child_process:962:15)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:101:24[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/nostr-unchained-integration.test.ts:132:7
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m {
    status: [33m1[39m,
    signal: [1mnull[22m,
    output: [
      [1mnull[22m,
      [32m''[39m,
      [32m'node:internal/modules/cjs/loader:1148\n'[39m +
        [32m'  throw err;\n'[39m +
        [32m'  ^\n'[39m +
        [32m'\n'[39m +
        [32m"Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'\n"[39m +
        [32m'    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)\n'[39m +
        [32m'    at Module._load (node:internal/modules/cjs/loader:986:27)\n'[39m +
        [32m'    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)\n'[39m +
        [32m'    at node:internal/main/run_main_module:28:49 {\n'[39m +
        [32m"  code: 'MODULE_NOT_FOUND',\n"[39m +
        [32m'  requireStack: []\n'[39m +
        [32m'}\n'[39m +
        [32m'\n'[39m +
        [32m'Node.js v20.16.0\n'[39m
    ],
    pid: [33m4137109[39m,
    stdout: [32m''[39m,
    stderr: [32m'node:internal/modules/cjs/loader:1148\n'[39m +
      [32m'  throw err;\n'[39m +
      [32m'  ^\n'[39m +
      [32m'\n'[39m +
      [32m"Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'\n"[39m +
      [32m'    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)\n'[39m +
      [32m'    at Module._load (node:internal/modules/cjs/loader:986:27)\n'[39m +
      [32m'    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)\n'[39m +
      [32m'    at node:internal/main/run_main_module:28:49 {\n'[39m +
      [32m"  code: 'MODULE_NOT_FOUND',\n"[39m +
      [32m'  requireStack: []\n'[39m +
      [32m'}\n'[39m +
      [32m'\n'[39m +
      [32m'Node.js v20.16.0\n'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'a0c0681c5118651e8bbd74484873151fc1cd31022fc385d649ec724576642c0f'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🧪 Phase 3 Integration Validation > should demonstrate that Phase 3 is ACTUALLY integrated
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'3000d145394fad6ff541669935bddc7a1a51f5947b9d624752af656c94c52ae3'[39m
}

🧪 PHASE 3 INTEGRATION VALIDATION
==================================
✅ Main API exposes StoreManager: [33mtrue[39m
✅ getConversation() method available: [33mtrue[39m
✅ StoreManager initialized: [33mtrue[39m
✅ Relay configuration present: [33mtrue[39m
📁 Created synchronized store for conversation: integration-test
✅ Public API fully usable: [33mtrue[39m

🎉 PHASE 3 INTEGRATION: COMPLETE SUCCESS!
   Developers can now use:
   - await NostrUnchained.create()
   - client.getConversation(id)
   - $conversation.messages in Svelte
   - Real-time updates with Umbrel relay
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🧪 Phase 3 Integration Validation > should match the originally promised Phase 3 API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'6c9612a7f4b8ffbe278b044544bd65e94a65301c207d62b84bccb7ce61177bfd'[39m
}
📁 Created synchronized store for conversation: api-validation
✅ API matches Phase 3 specifications
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🚀 Performance with Real API > should maintain sub-100ms performance through public API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'f778fe6160a47ea96afdfcfd46da0b022ceae089063e8e871c56b4f745c807cf'[39m
}
📁 Created synchronized store for conversation: performance-test
🌐 Global message event: performance-test
✅ API update time: 0.19ms (<100ms requirement)
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🔄 Resource Management > should cleanup Phase 3 resources on dispose
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'866606e297a2207ed029ba9f192208422714afe6ea9c9a1a9fffbf7691eb053d'[39m
}
📁 Created synchronized store for conversation: cleanup-test
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed
✅ Resource cleanup working correctly

 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts  (10 tests | 2 failed) 660ms
   ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
     → expected 0 to be greater than 0
stdout | unknown test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EOSE

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/real-event-publishing.test.ts:86:25
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
🔌 Disconnected from relay: ws://umbrel.local:4848
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'17ab6a9d9404de309a3b39d77692d58dbb7e4164c4baa543ad55919cbc2b2c6b'[39m
}

🗨️ Publishing to multiple conversations...
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 17ab6a9d9404de30...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 1 to chat-1 - 1752951051781..."
   🔑 PubKey: 9879726b811ad92f...
   ✍️ Signature: 9f33a9bd5400b7b4...
   🆔 Event ID: f203375a2791bf3d...
📁 Created synchronized store for conversation: chat-1
🔍 Waiting for relay connections... (currently 0)

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: f203375a2791bf3d73fad4da101ee84b3a0f3243730d09bf5da4d189429490d5
   Content: "Message 1 to chat-1 - 1752951051781..."
📤 Event sent to relay, waiting for response...

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
✅ Event ACCEPTED by relay: f203375a2791bf3d73fad4da101ee84b3a0f3243730d09bf5da4d189429490d5
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: chat-1
   📤 Published to chat-1: "Message 1 to chat-1 - 17529510..."

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 📊 Real-time Performance Validation > should meet real-time performance requirements under load
📊 Average update latency: 0.13ms
✅ DEMONSTRATED: Sustained real-time performance

 ❯ src/__tests__/phase3/real-time-updates.test.ts  (7 tests | 2 failed) 1202ms
   ❯ src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
     → expected 1 to be greater than 1
   ❯ src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should simulate event-driven real-time updates via Event Bus
     → expected 3 to be greater than or equal to 4
stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 What Phase 3 ACTUALLY delivers vs. promises > should honestly assess real-time capabilities

📋 HONEST ASSESSMENT OF PHASE 3 REAL-TIME CAPABILITIES:

What WORKS:
  ✅ Store reactivity and performance
  ✅ Event-driven architecture foundation
  ✅ Memory-bounded message handling
  ✅ Component-level real-time updates

What's MISSING:
  ❌ Store instance synchronization
  ❌ Real external event sources
  ❌ Cross-tab state coordination
  ❌ Network-driven real-time updates

🎯 CONCLUSION: Phase 3 provides "real-time" FOUNDATION
   but needs additional coordination for true real-time sync

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 9879726b811ad92f...

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 2 to chat-2 - 1752951052270..."
   🔑 PubKey: 757124a7302aca92...
   ✍️ Signature: 9f17ff35b504f7cc...
   🆔 Event ID: ba5e69040008b26c...
📁 Created synchronized store for conversation: chat-2
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: ba5e69040008b26cd87ba7c31da43926f76a3c57f276ecc5108c010a6d718de0
   Content: "Message 2 to chat-2 - 1752951052270..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
✅ Event ACCEPTED by relay: ba5e69040008b26cd87ba7c31da43926f76a3c57f276ecc5108c010a6d718de0
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store chat-1 about new message
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: chat-2
   📤 Published to chat-2: "Message 2 to chat-2 - 17529510..."

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 757124a7302aca92...

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📤 Published test event to Umbrel relay: Phase 3 Integration Test - 1752951051543

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📥 Received from Umbrel relay: [
  [32m'OK'[39m,
  [32m'test_1752951051543_359ik71w8'[39m,
  [33mfalse[39m,
  [32m'invalid: Event invalid id'[39m
]

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

2/3: Sending "📨 Multi-test 2: 1752951051560..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 8c1edaa7b4b4f349...

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 3 to group-discussion - 1752951052598..."
   🔑 PubKey: 7960878cd1e3fcd8...
   ✍️ Signature: a4f0ebec0634ef5c...
   🆔 Event ID: 9440e65d612218a3...
📁 Created synchronized store for conversation: group-discussion
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 9440e65d612218a33625ab8b78a401ac3c501f4ad7f1791b3630ddd20dfcea29
   Content: "Message 3 to group-discussion - 1752951052598..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
✅ Event ACCEPTED by relay: 9440e65d612218a33625ab8b78a401ac3c501f4ad7f1791b3630ddd20dfcea29
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store chat-1 about new message
🔄 Message sync - would notify store relay-messages about new message
🔄 Message sync - would notify store chat-2 about new message
🌐 Global message event: group-discussion
   📤 Published to group-discussion: "Message 3 to group-discussion ..."
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
   ❌ REJECTED: Error: Failed to create valid Nostr event
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/relay-response-test.test.ts:76:25
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should handle Umbrel relay with fallbacks
🌐 Connecting to 3 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Communication Performance > should establish connection within timeout period
🌐 Connecting to 1 relays...
Umbrel relay connection time: 1.76ms
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Communication Performance > should handle connection latency appropriately
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'fd81d793d4a58295a7f8e1f07e6dc22803aecd6e05b3a7ef668613eac8496784'[39m
}
Relay latency - Avg: 0.05ms, Max: 0.10ms
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should fallback when Umbrel relay fails
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Umbrel-Specific Features > should work with local network relay characteristics
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'8f1b8c0935c1bef7757dc05318459444eba4aa6c1c20af912fa42259422c40e2'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Umbrel-Specific Features > should handle Umbrel relay reconnection
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Protocol Compliance > should follow Nostr protocol standards with Umbrel relay
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Protocol Compliance > should handle WebSocket protocol correctly
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Multi-Relay Scenarios > should handle mixed local and remote relays
🌐 Connecting to 3 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Multi-Relay Scenarios > should prioritize Umbrel relay when available
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 2 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'f0cd41cf0d2dfaec52dcdce53bd159c8547baa1c07138bbd02abb2abb36f48c8'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Network Quality Adaptation > should adapt timeouts for local network conditions
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Network Quality Adaptation > should handle network congestion gracefully
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
🌐 Connecting to 1 relays...
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | unknown test
✅ Connected to relay: ws://umbrel.local:4848

 ❯ src/__tests__/phase2-relay.test.ts  (17 tests | 2 failed) 2110ms
   ❯ src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
     → promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
   ❯ src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
     → expected 1.8454670000000988 to be greater than 1500
stderr | unknown test
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | unknown test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'eb848db04c58ea7e07b32840ec21b9b3c044e6b7ae4e82b717ec24a0ce4fbc10'[39m
}
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: eb848db04c58ea7e...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
📝 Created REAL signed event using NostrUnchained: "Protocol compliance test..."
   🔑 PubKey: 1f0d438db5f57494...
   ✍️ Signature: e385565ada191364...
   🆔 Event ID: 6ae0a2e72890dd64...
📁 Created synchronized store for conversation: validation-test
🔍 Waiting for relay connections... (currently 0)
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 6ae0a2e72890dd64fceb9ccbc01fbca8e140af3cb518a9d315a279e7fdcd489b
   Content: "Protocol compliance test..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
✅ Event ACCEPTED by relay: 6ae0a2e72890dd64fceb9ccbc01fbca8e140af3cb518a9d315a279e7fdcd489b
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: validation-test
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'fdf7deca4ccabc5439135c0ba43207173bba461d3b22c9e5e5a6aead11768f40'[39m
}
📁 Created synchronized store for conversation: integration-test
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: fdf7deca4ccabc54...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
🔌 Disconnected from relay: ws://umbrel.local:4848
📝 Created REAL signed event using NostrUnchained: "Integration test message..."
   🔑 PubKey: e0d72c0e533acd86...
   ✍️ Signature: e7df357986ff3b15...
   🆔 Event ID: e9fc3c07ba52a03d...
🔍 Waiting for relay connections... (currently 0)

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: e9fc3c07ba52a03de0dbdab50f6d0a511f138142f9904acfcc4adb888a3a652b
   Content: "Integration test message..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
✅ Event ACCEPTED by relay: e9fc3c07ba52a03de0dbdab50f6d0a511f138142f9904acfcc4adb888a3a652b
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: integration-test

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🔑 Demo Public Key: 0000000000000000000000000000000000000000000000000000000066ceb0a5

🎯 Publishing VALID profile event to Umbrel...
📝 Profile Event Created:
  - ID: 000000000000000000000000000000000000000000000000000000005301ba13
  - Kind: [33m0[39m
  - PubKey: 0000000000000000000000000000000000000000000000000000000066ceb0a5
  - Content: {"name":"Phase 3 Demo User","about":"Testing nostr-unchained Phase 3 with real Umbrel relay","picture":"https://robohash.org/0000000000000000000000000000000000000000000000000000000066ceb0a5.png"}
  - Signature: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a38ce5

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
✅ Connected to Umbrel relay
📤 Profile event sent to relay

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay response: [
  [32m'OK'[39m,
  [32m'000000000000000000000000000000000000000000000000000000005301ba13'[39m,
  [33mfalse[39m,
  [32m'invalid: Event invalid id'[39m
]
❌ Event rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Real event publishing integrates perfectly with Phase 3 stores
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

 ❯ src/__tests__/phase3/real-event-publishing.test.ts  (5 tests | 4 failed) 2086ms
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
     → expected '📨 Multi-test 1: 1752951051559' to be '🎉 REAL EVENT from NostrUnchained API…' // Object.is equality
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
     → expected '9f33a9bd5400b7b4982f3243df5169d13573e…' to match /^[0-9a-f]{64}$/
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
     → expected 'e385565ada19136466211059cc00efdf53c2e…' to match /^[0-9a-f]{64}$/
stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📁 Created synchronized store for conversation: real-time-sync-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

3/3: Sending "📨 Multi-test 3: 1752951051561..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 8c1edaa7b4b4f349...

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📝 Created REAL signed event using NostrUnchained: "📨 Multi-test 3: 1752951051561..."
   🔑 PubKey: 8f29a9f3b27047fb...
   ✍️ Signature: 23219951dfbe81b5...
   🆔 Event ID: e4689d9eb1dafd66...
📁 Created synchronized store for conversation: multi-test
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: e4689d9eb1dafd6602a806a2aa7360c5bb4ebced0add5a1288ccf22082ac0651
   Content: "📨 Multi-test 3: 1752951051561..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
✅ Event ACCEPTED by relay: e4689d9eb1dafd6602a806a2aa7360c5bb4ebced0add5a1288ccf22082ac0651
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: multi-test
   ✅ ACCEPTED: e4689d9eb1dafd6602a806a2aa7360c5bb4ebced0add5a1288ccf22082ac0651

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

📊 RESULTS SUMMARY:
   1: ❌ REJECTED - Error: Failed to create valid Nostr event
   2: ❌ REJECTED - Error: Failed to create valid Nostr event
   3: ✅ ACCEPTED

🎯 Total accepted: 1/3
✅ At least some events were accepted by Umbrel!
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'a0e5418d2ba6b6c064e3c0b62d2cc048e4d3bf4f5677d945c4eb2c8979812b95'[39m
}
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: a0e5418d2ba6b6c0...
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📝 Created REAL signed event using NostrUnchained: "Debug info test..."
   🔑 PubKey: 8bf93b3d94576f6d...
   ✍️ Signature: 7df37af6943bb7f3...
   🆔 Event ID: e0ef073841f51b34...
📁 Created synchronized store for conversation: debug-test
🔍 Waiting for relay connections... (currently 0)

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: e0ef073841f51b34045105557560c804a6bbfcbe8c69ffe887066c7047a28a48
   Content: "Debug info test..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
✅ Event ACCEPTED by relay: e0ef073841f51b34045105557560c804a6bbfcbe8c69ffe887066c7047a28a48
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: debug-test

🔍 DETAILED EVENT INFORMATION:
==============================
Event ID: e0ef073841f51b34045105557560c804a6bbfcbe8c69ffe887066c7047a28a48
Public Key: 8bf93b3d94576f6d6fda106e5f2599bc221b04ed2bff3a6b50657ad8bc9b7bb5
Signature: 7df37af6943bb7f3c6cd33da6ba2c64e9deb167bbacbf036b0dc78186496b643a4f44ec44b4abf30fa116ef213c1d3f0c4b98bec1fa58a11529f39ac383601de
Timestamp: 1752951055
Kind: 1
Tags: []
Content: "Debug info test"
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

 ❯ src/__tests__/phase3/relay-response-test.test.ts  (3 tests | 2 failed) 3760ms
   ❯ src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
     → expected '7df37af6943bb7f3c6cd33da6ba2c64e9deb1…' to match /^[0-9a-f]{64}$/
stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🎉 Profile event published! Check your Umbrel interface.
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📁 Created synchronized store for conversation: rapid-updates-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000001a7db81c

🎯 Publishing multiple VALID text notes...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
✅ Connected to Umbrel for bulk publishing
📝 1/5: "Hello from nostr-unchained Phase 3! 🚀"
   Event ID: 00000000000000000000000000000000000000000000000000000000386b0baf

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 1 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 2/5: "This is a real Nostr event with valid signatures ✅"
   Event ID: 00000000000000000000000000000000000000000000000000000000279e88c8

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 2 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 3/5: "Your Umbrel relay should show these messages 📡"
   Event ID: 000000000000000000000000000000000000000000000000000000007c9c3caa

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 3 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 4/5: "Phase 3 Store System is working perfectly! 🎯"
   Event ID: 00000000000000000000000000000000000000000000000000000000627c12bf

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 4 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 5/5: "Real-time updates + Umbrel integration = Success! 🎉"
   Event ID: 000000000000000000000000000000000000000000000000000000007c0d97da

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 5 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📊 Published 5 text notes to Umbrel
🎉 Check your Umbrel interface - you should see activity!

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together

🎯 FINAL PHASE 3 DEMONSTRATION
===============================
1️⃣ Testing store synchronization...
📁 Created synchronized store for conversation: final-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts  (7 tests | 7 failed) 14043ms
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
     → Message must have valid ID
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
     → Message must have valid ID
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
     → Message must have valid ID
stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000002a6535bf

🎯 Creating conversation with mentions...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
✅ Connected for conversation publishing
💬 1/4: "Starting a new conversation on Umbrel relay! 💬..."
   From: 0000000000000000...
   Tags: []

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
🔍 Connection closed. Published: [33mtrue[39m Received: [33mfalse[39m

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
📡 Connected to Umbrel relay for subscription test

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
📨 Received event 1: Debug info test
📨 Received event 2: 📨 Multi-test 3: 1752951051561
📨 Received event 3: Integration test message
📨 Received event 4: Protocol compliance test
📨 Received event 5: Message 3 to group-discussion - 1752951052598
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
📊 Test Summary: Received 5 events from Umbrel relay

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Store Integration with Real Events > should handle real Nostr events in store and maintain state correctly
✅ Store correctly processed real Nostr DM event
📊 Store state: {
  messageCount: [33m1[39m,
  unreadCount: [33m1[39m,
  lastActivity: [32m'2025-07-19T18:51:06.636Z'[39m
}

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Store Integration with Real Events > should maintain conversation history with mixed real and test events
✅ Store correctly handles mixed real/test events

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Performance with Real Relay Data > should maintain performance standards with real relay latency
✅ Performance maintained with rapid real-world message simulation

 ❯ src/__tests__/phase3/relay-integration.test.ts  (8 tests | 2 failed) 15462ms
   ❯ src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
     → Test timeout
   ❯ src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real-world Error Handling > should handle malformed events gracefully
     → expected 1 to be 3 // Object.is equality
stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
💬 2/4: "Hey @00000000... - this is a mention test!..."
   From: 0000000000000000...
   Tags: [["p","0000000000000000000000000000000000000000000000000000000073d4775a"]]

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
💬 3/4: "Thanks @00000000... for the mention! This is worki..."
   From: 0000000000000000...
   Tags: [["p","000000000000000000000000000000000000000000000000000000002a6535bf"]]

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
💬 4/4: "Phase 3 conversation demo complete! Your Umbrel no..."
   From: 0000000000000000...
   Tags: []

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
💬 Conversation published to Umbrel!
👥 Two different users had a conversation on your relay
🎯 Your Umbrel should now show multiple events and activity!

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🔑 Demo Public Key: 00000000000000000000000000000000000000000000000000000000531f0da9

🔍 Verifying events are stored in Umbrel...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
✅ Connected for verification test

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📤 Test event publish response: rejected

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🔍 Querying relay for stored events...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📨 Found stored event: "Debug info test..."
📨 Found stored event: "📨 Multi-test 3: 1752951051561..."
📨 Found stored event: "Integration test message..."
📨 Found stored event: "Protocol compliance test..."
📨 Found stored event: "Message 3 to group-discussion - 17529510..."
📨 Found stored event: "Message 2 to chat-2 - 1752951052270..."
📨 Found stored event: "Message 1 to chat-1 - 1752951051781..."
📨 Found stored event: "📨 Multi-test 1: 1752951051559..."
📨 Found stored event: "Hello from the integrated API!..."
📨 Found stored event: "Message to chat 2..."
✅ Query complete - found 10 stored events
📊 Verification complete: 10 events found in relay storage
🎉 SUCCESS: Your Umbrel relay is storing and serving events!
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🔑 Demo Public Key: 0000000000000000000000000000000000000000000000000000000064f6dadc

🎉 FINAL CELEBRATION EVENT
========================
🎯 Final Event Details:
  Content Length: [33m301[39m characters
  Event ID: 000000000000000000000000000000000000000000000000000000005f245b88
  Timestamp: 2025-07-19T18:51:18.000Z

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🚀 Publishing final celebration event...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
❌ Celebration event rejected: invalid: Event invalid id

✅ Phase 3 Umbrel integration COMPLETE!
🔍 Check your Umbrel interface at ws://umbrel.local:4848
📊 You should now see real Nostr activity!
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase3/umbrel-real-events.test.ts  (5 tests | 2 failed) 28131ms
   ❯ src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
     → Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   ❯ src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
     → Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".

⎯⎯⎯⎯⎯⎯ Failed Suites 2 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/crypto/__tests__/chacha20-poly1305.test.ts [ src/crypto/__tests__/chacha20-poly1305.test.ts ]
Error: Failed to resolve import "../core/chacha20-poly1305" from "src/crypto/__tests__/chacha20-poly1305.test.ts". Does the file exist?
 ❯ formatError node_modules/vite/dist/node/chunks/dep-827b23df.js:44066:46
 ❯ TransformContext.error node_modules/vite/dist/node/chunks/dep-827b23df.js:44062:19
 ❯ normalizeUrl node_modules/vite/dist/node/chunks/dep-827b23df.js:41845:33
 ❯ async file:/home/sascha-laptop/bitsperity-libs/nostr-unchained/node_modules/vite/dist/node/chunks/dep-827b23df.js:41999:47
 ❯ TransformContext.transform node_modules/vite/dist/node/chunks/dep-827b23df.js:41915:13
 ❯ Object.transform node_modules/vite/dist/node/chunks/dep-827b23df.js:44356:30
 ❯ loadAndTransform node_modules/vite/dist/node/chunks/dep-827b23df.js:55088:29

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/32]⎯

 FAIL  src/crypto/__tests__/nip44-compliance.test.ts [ src/crypto/__tests__/nip44-compliance.test.ts ]
Error: Failed to resolve import "../nip44" from "src/crypto/__tests__/nip44-compliance.test.ts". Does the file exist?
 ❯ formatError node_modules/vite/dist/node/chunks/dep-827b23df.js:44066:46
 ❯ TransformContext.error node_modules/vite/dist/node/chunks/dep-827b23df.js:44062:19
 ❯ normalizeUrl node_modules/vite/dist/node/chunks/dep-827b23df.js:41845:33
 ❯ async file:/home/sascha-laptop/bitsperity-libs/nostr-unchained/node_modules/vite/dist/node/chunks/dep-827b23df.js:41999:47
 ❯ TransformContext.transform node_modules/vite/dist/node/chunks/dep-827b23df.js:41915:13
 ❯ Object.transform node_modules/vite/dist/node/chunks/dep-827b23df.js:44356:30
 ❯ loadAndTransform node_modules/vite/dist/node/chunks/dep-827b23df.js:55088:29

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/32]⎯

⎯⎯⎯⎯⎯⎯ Failed Tests 30 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
AssertionError: expected 'temporary' to be 'nip07' // Object.is equality

- Expected
+ Received

- nip07
+ temporary

 ❯ src/__tests__/nostr-unchained.test.ts:92:42
     90|       
     91|       expect(instance.signer).toBeDefined();
     92|       expect(instance.signer!.info.type).toBe('nip07');
       |                                          ^
     93|       expect(instance.signer!.info.capabilities.supportsNip07).toBe(tr…
     94|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/32]⎯

 FAIL  src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
AssertionError: expected 'temporary' to be 'nip07' // Object.is equality

- Expected
+ Received

- nip07
+ temporary

 ❯ src/__tests__/nostr-unchained.test.ts:150:31
    148|       
    149|       expect(signerInfo).toBeDefined();
    150|       expect(signerInfo.type).toBe('nip07');
       |                               ^
    151|       expect(signerInfo.capabilities).toBeDefined();
    152|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/32]⎯

 FAIL  src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
AssertionError: promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
 ❯ src/__tests__/phase2-integration.test.ts:113:7
    111|           timeout: 2000, // Short timeout to fail fast
    112|         })
    113|       ).rejects.toThrow();
       |       ^
    114|     });
    115| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/32]⎯

 FAIL  src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
AssertionError: promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
 ❯ src/__tests__/phase2-relay.test.ts:129:7
    127|           timeout: 3000, // Short timeout
    128|         })
    129|       ).rejects.toThrow();
       |       ^
    130|     });
    131| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/32]⎯

 FAIL  src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
AssertionError: expected 1.8454670000000988 to be greater than 1500
 ❯ src/__tests__/phase2-relay.test.ts:172:27
    170|         
    171|         // Should have attempted retries (minimum time with retries)
    172|         expect(totalTime).toBeGreaterThan(1500); // At least 2 retry a…
       |                           ^
    173|         expect(totalTime).toBeLessThan(8000); // But not too long
    174|         

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/32]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
StoreError: Message must have valid ID
 ❯ DMConversationStore.addMessage src/stores/dm-conversation.ts:118:13
    116| 
    117|     if (!message?.id) {
    118|       throw new StoreError('Message must have valid ID', 'INVALID_MESS…
       |             ^
    119|     }
    120| 
 ❯ StoreManager.addMessage src/stores/store-manager.ts:144:17
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:82:26

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'INVALID_MESSAGE', conversationId: 'real-time-sync-demo' }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/32]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
StoreError: Message must have valid ID
 ❯ DMConversationStore.addMessage src/stores/dm-conversation.ts:118:13
    116| 
    117|     if (!message?.id) {
    118|       throw new StoreError('Message must have valid ID', 'INVALID_MESS…
       |             ^
    119|     }
    120| 
 ❯ StoreManager.addMessage src/stores/store-manager.ts:144:17
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:133:28

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'INVALID_MESSAGE', conversationId: 'rapid-updates-demo' }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/32]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:163:34
    161|     it('should connect to Umbrel relay and publish actual events', asy…
    162|       // Test relay connection
    163|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    164|       
    165|       if (!connectionOk) {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/32]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:211:34
    209| 
    210|     it('should handle multiple events to Umbrel relay in rapid success…
    211|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    212|       if (!connectionOk) {
    213|         console.warn('⚠️ Skipping - Umbrel relay not available');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/32]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:266:34
    264| 
    265|     it('should receive events from relay and update stores in real-tim…
    266|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    267|       if (!connectionOk) {
    268|         console.warn('⚠️ Skipping - Umbrel relay not available');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/32]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:313:34
    311|     
    312|     it('should maintain performance with many stores and real relay pu…
    313|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    314|       
    315|       // Create multiple conversation stores

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/32]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
StoreError: Message must have valid ID
 ❯ DMConversationStore.addMessage src/stores/dm-conversation.ts:118:13
    116| 
    117|     if (!message?.id) {
    118|       throw new StoreError('Message must have valid ID', 'INVALID_MESS…
       |             ^
    119|     }
    120| 
 ❯ StoreManager.addMessage src/stores/store-manager.ts:144:17
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:386:26

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'INVALID_MESSAGE', conversationId: 'final-demo' }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/32]⎯

 FAIL  src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Svelte Readable Contract > should notify subscribers when state changes
AssertionError: expected 1 to be greater than or equal to 2
 ❯ src/__tests__/phase3/dm-conversation-store.test.ts:76:29
     74| 
     75|       // Should have initial state + updated state
     76|       expect(states.length).toBeGreaterThanOrEqual(2);
       |                             ^
     77|       expect(states[states.length - 1].messages).toHaveLength(1);
     78|       expect(states[states.length - 1].messages[0].id).toBe(message.id…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/32]⎯

 FAIL  src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Message Management > should handle duplicate messages correctly
AssertionError: expected 2 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 2

 ❯ src/__tests__/phase3/dm-conversation-store.test.ts:127:33
    125|       const state = store.state;
    126|       expect(state.messages).toHaveLength(1); // Should not duplicate
    127|       expect(state.unreadCount).toBe(1); // Should not increment twice
       |                                 ^
    128|     });
    129| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/32]⎯

 FAIL  src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Lifecycle Management > should prevent operations on disposed store
AssertionError: expected [Function] to throw error including 'STORE_DISPOSED' but got 'Cannot add message to disposed store'

- Expected
+ Received

- STORE_DISPOSED
+ Cannot add message to disposed store

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/32]⎯

 FAIL  src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ StoreManager.sendMessage src/stores/store-manager.ts:102:19
 ❯ NostrUnchainedImpl.sendMessage src/core/nostr-unchained-impl.ts:76:12
 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts:132:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/32]⎯

 FAIL  src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
AssertionError: expected 0 to be greater than 0
 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts:150:38
    148|       const status = client.storeManager!.getConnectionStatus();
    149|       
    150|       expect(status.connectedRelays).toBeGreaterThan(0);
       |                                      ^
    151|       console.log(`🌐 Connected to ${status.connectedRelays} relay(s)`)…
    152|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/32]⎯

 FAIL  src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Automatic Subscription Cleanup
AssertionError: expected 1 to be +0 // Object.is equality

- Expected
+ Received

- 0
+ 1

 ❯ src/__tests__/phase3/phase3-scope-validation.test.ts:72:47
     70|       
     71|       await store.dispose();
     72|       expect(store.metrics.subscriptionCount).toBe(0);
       |                                               ^
     73|       
     74|       console.log('✅ DELIVERED: Memory leak prevention works');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/32]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
AssertionError: expected '📨 Multi-test 1: 1752951051559' to be '🎉 REAL EVENT from NostrUnchained API…' // Object.is equality

- Expected
+ Received

- 🎉 REAL EVENT from NostrUnchained API! 1752951051470
+ 📨 Multi-test 1: 1752951051559

 ❯ src/__tests__/phase3/real-event-publishing.test.ts:40:39
     38|       
     39|       expect(publishedEvent).toBeDefined();
     40|       expect(publishedEvent!.content).toBe(messageContent);
       |                                       ^
     41|       
     42|              // Verify it's a real event, not a fake one

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/32]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ StoreManager.sendMessage src/stores/store-manager.ts:102:19
 ❯ NostrUnchainedImpl.sendMessage src/core/nostr-unchained-impl.ts:76:12
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:86:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/32]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
AssertionError: expected '9f33a9bd5400b7b4982f3243df5169d13573e…' to match /^[0-9a-f]{64}$/
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:140:28
    138|              publishedEvents.forEach((event, i) => {
    139|          expect(event.pubkey).toMatch(/^[0-9a-f]{64}$/);
    140|          expect(event.sig).toMatch(/^[0-9a-f]{64}$/); // Schnorr signa…
       |                            ^
    141|          
    142|          // Each event should have unique ID and timestamp
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:138:30

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/32]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
AssertionError: expected 'e385565ada19136466211059cc00efdf53c2e…' to match /^[0-9a-f]{64}$/
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:171:27
    169|        expect(event!.id).toMatch(/^[0-9a-f]{64}$/); // 64-char hex
    170|        expect(event!.pubkey).toMatch(/^[0-9a-f]{64}$/); // 64-char hex
    171|        expect(event!.sig).toMatch(/^[0-9a-f]{64}$/); // 64-char hex (S…
       |                           ^
    172|       
    173|       // Timestamp should be recent

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/32]⎯

 FAIL  src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
AssertionError: expected 1 to be greater than 1
 ❯ src/__tests__/phase3/real-time-updates.test.ts:71:36
     69|       
     70|       // But each store DOES update in real-time internally
     71|       expect(store1Updates.length).toBeGreaterThan(1); // Initial + up…
       |                                    ^
     72|       expect(store2Updates.length).toBe(1); // Only initial
     73|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/32]⎯

 FAIL  src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should simulate event-driven real-time updates via Event Bus
AssertionError: expected 3 to be greater than or equal to 4
 ❯ src/__tests__/phase3/real-time-updates.test.ts:110:30
    108|       
    109|       // Should have multiple updates (initial + 3 messages)
    110|       expect(updates.length).toBeGreaterThanOrEqual(4);
       |                              ^
    111|       
    112|       // Verify chronological updates

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/32]⎯

 FAIL  src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
Error: Test timeout
 ❯ Timeout._onTimeout src/__tests__/phase3/relay-integration.test.ts:120:18
    118|         const timeout = setTimeout(() => {
    119|           ws.close();
    120|           reject(new Error('Test timeout'));
       |                  ^
    121|         }, 15000);
    122| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/32]⎯

 FAIL  src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real-world Error Handling > should handle malformed events gracefully
AssertionError: expected 1 to be 3 // Object.is equality

- Expected
+ Received

- 3
+ 1

 ❯ src/__tests__/phase3/relay-integration.test.ts:411:29
    409|       }
    410| 
    411|       expect(errorsHandled).toBe(malformedEvents.length);
       |                             ^
    412|       
    413|       // Store should still be functional after errors

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/32]⎯

 FAIL  src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ StoreManager.sendMessage src/stores/store-manager.ts:102:19
 ❯ NostrUnchainedImpl.sendMessage src/core/nostr-unchained-impl.ts:76:12
 ❯ src/__tests__/phase3/relay-response-test.test.ts:40:23

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/32]⎯

 FAIL  src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
AssertionError: expected '7df37af6943bb7f3c6cd33da6ba2c64e9deb1…' to match /^[0-9a-f]{64}$/
 ❯ src/__tests__/phase3/relay-response-test.test.ts:129:30
    127|       expect(testEvent!.id).toMatch(/^[0-9a-f]{64}$/);
    128|       expect(testEvent!.pubkey).toMatch(/^[0-9a-f]{64}$/);
    129|       expect(testEvent!.sig).toMatch(/^[0-9a-f]{64}$/);
       |                              ^
    130|       expect(testEvent!.kind).toBe(1);
    131|       expect(testEvent!.created_at).toBeTypeOf('number');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/32]⎯

 FAIL  src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
 FAIL  src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/32]⎯

⎯⎯⎯⎯⎯⎯ Unhandled Errors ⎯⎯⎯⎯⎯⎯

Vitest caught 12 unhandled errors during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:81:40
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runFiles node_modules/@vitest/runner/dist/index.js:834:5
 ❯ startTests node_modules/@vitest/runner/dist/index.js:843:3

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should handle rapid real-time updates across components without performance loss". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:387:22
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runFiles node_modules/@vitest/runner/dist/index.js:834:5
 ❯ startTests node_modules/@vitest/runner/dist/index.js:843:3

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 Test Files  14 failed | 2 passed (16)
      Tests  30 failed | 131 passed (161)
     Errors  12 errors
   Start at  20:50:47
   Duration  30.94s (transform 568ms, setup 1.92s, collect 2.33s, tests 68.67s, environment 13.35s, prepare 2.72s)


 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
[3Jc
 RERUN  src/stores/dm-conversation.ts

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Native Svelte Readable Store Contract
✅ DELIVERED: Native Svelte $conversation.messages syntax support

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Memory-bounded LRU Message History (1000 messages)
✅ DELIVERED: LRU memory management works perfectly

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Cross-Tab Sync Infrastructure (BroadcastChannel)
Cross-tab sync supported: [33mtrue[39m
✅ DELIVERED: Cross-tab sync infrastructure ready

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Performance Requirements (<100ms store updates)
✅ DELIVERED: Store update in 0.30ms (<100ms requirement)

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should connect to Umbrel relay successfully
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'a5d06af1b0397a9899d6adbd46f8cb9dd05f394d4b5622136b0c4de1e62cd473'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'241faa4115bf991a05aeb81df8a87f472a94d1ae2f2b6432779861fc55df49e8'[39m
}

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
Store 1 messages: [33m1[39m
Store 2 messages: [33m0[39m
⚠️ LIMITATION EXPOSED: Stores don't share state without proper integration

 ❯ src/__tests__/phase3/dm-conversation-store.test.ts  (28 tests | 3 failed) 66ms
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Svelte Readable Contract > should notify subscribers when state changes
     → expected 1 to be greater than or equal to 2
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Message Management > should handle duplicate messages correctly
     → expected 2 to be 1 // Object.is equality
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Lifecycle Management > should prevent operations on disposed store
     → expected [Function] to throw error including 'STORE_DISPOSED' but got 'Cannot add message to disposed store'
stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ Real Nostr Event Publishing (needs Phase 5 crypto)
🔌 Umbrel relay is reachable...
❌ CANNOT DELIVER: Real event publishing because:
    1. No Event ID calculation (SHA256 of serialized event)
    2. No Event signing (secp256k1 private key needed)
    3. No proper event serialization
    4. No NIP-01 compliance validation

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ Real Event Subscription (needs Phase 4 network layer)
❌ CANNOT DELIVER: Real relay subscription because:
   1. No WebSocket relay management (Phase 4)
   2. No NIP-01 subscription filters
   3. No event validation and parsing
   4. No relay error handling

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ DM Encryption/Decryption (needs Phase 2+ integration)
❌ CANNOT DELIVER: DM encryption because:
   1. No NIP-44 encryption integration yet
   2. No gift wrap (NIP-59) implementation
   3. No key management for conversations

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store State Management with Mock Events
🎯 CORRECTLY TESTED: Store state management

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store Integration with Event Bus
🎯 CORRECTLY TESTED: Event bus integration

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store Memory Management under Load
🎯 CORRECTLY TESTED: Memory management under load

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 📋 Phase 3 Honest Assessment Summary > 📊 What we ACTUALLY delivered vs. what we CLAIMED

📋 HONEST PHASE 3 ASSESSMENT:

Claimed Deliverables:
   ✅ DMConversation Store: Native Svelte Readable
   ✅ Subscription Lifecycle: Automatic cleanup
   ❌ Cross-Tab Sync: Infrastructure only (no real testing)
   ✅ Memory Management: LRU 1000 messages perfect
   ⚠️ SSR Compatibility: Not tested yet
   ✅ Performance: <100ms updates achieved

Actual Capabilities:
   Store works perfectly with mock events
   Relay connection works but cannot publish valid events
   Missing Phase 4 (Network) and Phase 5 (Event Creation) integration
   Store is ready to receive real events when other phases complete

🎯 CONCLUSION: Phase 3 store system works perfectly
   but needs Phase 4+5 for real Nostr integration

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
✅ Connected to relay: ws://umbrel.local:4848

 ❯ src/__tests__/phase3/phase3-scope-validation.test.ts  (12 tests | 1 failed) 76ms
   ❯ src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Automatic Subscription Cleanup
     → expected 1 to be +0 // Object.is equality
stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'56eee19680add239045c14d49d58970b8fbab9f5ed29cc62372192a20c334e0c'[39m
}

🎯 Publishing REAL signed event...
===============================
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 56eee19680add239...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Crypto-Enhanced Foundation Layer > should initialize with crypto support and Umbrel relay
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'8bb0406190b53a60b51411e8eb02fa9c79fb93a987d661e16c31d64ff523ac22'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should connect to Umbrel relay successfully
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'f7a7922a1e258e9d348c33efb088ee0ace8702f161fbbe86f39a95bf6fc1650d'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should fallback to default relays when Umbrel unavailable
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'd528d18ebee2f001ab1f8bca68df550da117ff06f5b0ab63734fe0a8aca22b61'[39m
}

🎯 TESTING REAL RELAY ACCEPTANCE...
==========================================
📝 Sending message: "🔬 Relay Test 1752951163660 - Testing acceptance"
⏳ Waiting for relay response...
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: d528d18ebee2f001...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
🔌 Disconnected from relay: ws://invalid.umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m
❌ Relay connection error ws://invalid.umbrel.local:4848: Event { isTrusted: [36m[Getter][39m }

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should handle high-frequency real-time updates without performance degradation
✅ DEMONSTRATED: High-frequency updates handled efficiently

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should demonstrate WHY we need proper state synchronization

🔍 DEMONSTRATING THE REAL PROBLEM:
💬 Chat component messages: [33m1[39m
🔔 Notification component messages: [33m0[39m
💬 Chat unread count: [33m1[39m
🔔 Notification unread count: [33m0[39m

❌ PROBLEM: Different store instances don't share state!
🔧 SOLUTION NEEDED: Proper state synchronization mechanism

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should show a working solution with Event Bus coordination

🔧 DEMONSTRATING A WORKING SOLUTION:
📡 Event bus received message:added event

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should show a working solution with Event Bus coordination
✅ Event bus coordination demonstrated
💡 Next step: Implement proper store synchronization

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🔌 Disconnected from relay: ws://offline.umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
❌ Relay connection error ws://offline.umbrel.local:4848: Event { isTrusted: [36m[Getter][39m }

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📝 Created REAL signed event using NostrUnchained: "🎉 REAL EVENT from NostrUnchained API! 17529511635..."
   🔑 PubKey: beaeb31bfac81b16...
   ✍️ Signature: 43358c0cadc063e7...
   🆔 Event ID: 1dacd2751483b2c9...
📁 Created synchronized store for conversation: real-event-test
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 1dacd2751483b2c905a473d8824371353922462ca0ba73c7b734a9095474a01c
   Content: "🔬 Relay Test 1752951163660 - Testing acceptance..."
📤 Event sent to relay, waiting for response...
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should cleanup crypto resources on disposal
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Concurrent Operations > should handle multiple concurrent crypto operations
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should expose store system through main API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'd15dbb89826a6062659f2ab19d802d7803a0dd46108c009d26c08d829507d368'[39m
}
✅ StoreManager accessible via client.storeManager
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should provide conversation stores via getConversation()
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'5ab9cc38173bfcf6352e713140da24aed4a7e967cd8c211c2be78b89a4e70264'[39m
}
📁 Created synchronized store for conversation: test-chat-api
✅ client.getConversation() working correctly
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should work with Svelte $conversation reactive syntax
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'e8c1a862d8d24e651b881ab4288ed62ea36d3584ce8e6cf7c6e7c91082d4bc5b'[39m
}
📁 Created synchronized store for conversation: svelte-test
✅ Svelte reactive subscription working
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'2e4142b16f61027ce86862701059eecd1c98585eca5f4f9aa85a8c681b6d2977'[39m
}

🎯 Testing real developer workflow...
1️⃣ Client created and initialized
📁 Created synchronized store for conversation: user-workflow-test
2️⃣ Conversation obtained via API
3️⃣ Subscribed to conversation updates
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 2e4142b16f61027c...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
✅ Event ACCEPTED by relay: 1dacd2751483b2c905a473d8824371353922462ca0ba73c7b734a9095474a01c
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: real-event-test
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'de48dc42e3d678f40108b1c8ec359b854d3734dfcf6022a4633422e534b16471'[39m
}

🔍 DEMONSTRATING API DIFFERENCES:
=================================
1️⃣ Using sendMessage() (RECOMMENDED):
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: de48dc42e3d678f4...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Concurrent Operations > should handle multiple concurrent crypto operations
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📡 Connected to Umbrel relay for publish test

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/relay-response-test.test.ts:40:23
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
❌ FAILED! Event was REJECTED by relay!
   Error: Error: Failed to create valid Nostr event
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'ccd8d9a1362aecc233ca4bb064518117a747f731487e4390f6f13875cba54af3'[39m
}

🗨️ TESTING MULTIPLE EVENTS...
==============================

1/3: Sending "📨 Multi-test 1: 1752951163828..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: ccd8d9a1362aecc2...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📥 Received from Umbrel relay: [ [32m'EOSE'[39m, [32m'phase3-test-sub'[39m ]

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Concurrent Operations > should maintain data integrity under concurrent load
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should recover from crypto operation failures
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should recover from crypto operation failures
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should handle Umbrel relay disconnections gracefully
🌐 Connecting to 2 relays...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should handle Umbrel relay disconnections gracefully
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase2-integration.test.ts  (15 tests | 1 failed) 402ms
   ❯ src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
     → promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
📝 Created REAL signed event using NostrUnchained: "Real message via sendMessage()..."
   🔑 PubKey: 2b319b31fd3bbd96...
   ✍️ Signature: da2f001ac24b687a...
   🆔 Event ID: 605c11a9fdd79610...
📁 Created synchronized store for conversation: api-demo
🔍 Waiting for relay connections... (currently 0)

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

 ❯ src/__tests__/nostr-unchained.test.ts  (18 tests | 2 failed) 197ms
   ❯ src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
     → expected 'temporary' to be 'nip07' // Object.is equality
   ❯ src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
     → expected 'temporary' to be 'nip07' // Object.is equality
stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize with default configuration
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize with custom configuration
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'b1907ed476aad70a5de92378cae557a19f2f571573b8bb563efca2c0c4bd2b12'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize in <200ms
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Builder Pattern > should create instance with builder pattern
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'e6a390c4fcbac18937e995c0ff04bace9c393ab3023e5f46cf2bbab69402dc8f'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Builder Pattern > should chain builder methods fluently
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should fallback to temporary signer when NIP-07 not available
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should provide signer capabilities
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should emit initialization events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should dispose resources properly
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should handle multiple dispose calls gracefully
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should emit disposal events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/nostr-unchained-integration.test.ts:98:7
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'abfc09f36cd544b4e4b9c9c0dcd40749e8155d386842d2411ef21fd94dc348f9'[39m
}
📁 Created synchronized store for conversation: multi-chat-1
📁 Created synchronized store for conversation: multi-chat-2
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: abfc09f36cd544b4...
✅ Connected to relay: ws://umbrel.local:4848
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 605c11a9fdd79610cef595667ab5740c9ade3f05c4e62c2506e2be64e062e05f
   Content: "Hello from the integrated API!..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📝 Created REAL signed event using NostrUnchained: "📨 Multi-test 1: 1752951163828..."
   🔑 PubKey: e5e6cefcb381c9ef...
   ✍️ Signature: 845cb7d1a3f16846...
   🆔 Event ID: 37550e843620aef7...
📁 Created synchronized store for conversation: multi-test
🔍 Waiting for relay connections... (currently 0)

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
✅ Event ACCEPTED by relay: 605c11a9fdd79610cef595667ab5740c9ade3f05c4e62c2506e2be64e062e05f
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: api-demo
   ✅ Real pubkey: 2b319b31fd3bbd96...
   ✅ Real signature: da2f001ac24b687a...
   ✅ Will be published to relay and accepted

2️⃣ Using addMessage() with fake event (DEMO ONLY):
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 2b319b31fd3bbd96...

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 37550e843620aef73de387cc68936ec6b3773f83cc1e6d90c91a32b809b849ee
   Content: "Hello from the integrated API!..."
📤 Event sent to relay, waiting for response...
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
📝 Created REAL signed event using NostrUnchained: "Message to chat 1..."
   🔑 PubKey: 1d3167d1be9747f0...
   ✍️ Signature: ee5519270dd8268b...
   🆔 Event ID: cbca8b5238738940...
🔍 Waiting for relay connections... (currently 0)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EOSE
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at startTests [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:843:3[90m)[39m
    at [90mfile:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mvitest[24m/dist/entry.js:103:7 {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/real-event-publishing.test.ts:94:25
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m
      at startTests [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:843:3[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'c8b0bdd63e12b01777e35540964252d7148cdd28047b00d10d1a199fbe0e3dd3'[39m
}

🗨️ Publishing to multiple conversations...
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: c8b0bdd63e12b017...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
✅ Event ACCEPTED by relay: 37550e843620aef73de387cc68936ec6b3773f83cc1e6d90c91a32b809b849ee
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: multi-test
   ✅ ACCEPTED: 37550e843620aef73de387cc68936ec6b3773f83cc1e6d90c91a32b809b849ee

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: cbca8b5238738940b3fb10d4827bb2b797c7a2ae84ba6d75bd647295b905c56a
   Content: "Demo message (fake event)..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
✅ Event ACCEPTED by relay: cbca8b5238738940b3fb10d4827bb2b797c7a2ae84ba6d75bd647295b905c56a
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store multi-chat-2 about new message
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: multi-chat-1
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 1d3167d1be9747f0...
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
🔌 Disconnected from relay: ws://umbrel.local:4848
📝 Created REAL signed event using NostrUnchained: "Message 1 to chat-1 - 1752951164216..."
   🔑 PubKey: c45ed248f49bb0d6...
   ✍️ Signature: 9a409eb4b2e14dea...
   🆔 Event ID: ba0490ba8784cd22...
📁 Created synchronized store for conversation: chat-1
🔍 Waiting for relay connections... (currently 0)

node:internal/fs/promises:639
  return new FileHandle(await PromisePrototypeThen(
                        ^

Error: ENOENT: no such file or directory, open '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at async open (node:internal/fs/promises:639:25)
    at async readFile (node:internal/fs/promises:1249:14)
    at async getSource (node:internal/modules/esm/load:46:14)
    at async defaultLoad (node:internal/modules/esm/load:137:34)
    at async ModuleLoader.load (node:internal/modules/esm/loader:396:7)
    at async ModuleLoader.moduleProvider (node:internal/modules/esm/loader:278:45)
    at async link (node:internal/modules/esm/module_job:78:21) {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
}

Node.js v20.16.0
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts  (10 tests | 3 failed) 679ms
   ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
     → expected 0 to be greater than 0
stderr | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/nostr-unchained-integration.test.ts:133:7
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'aad6cbf7c037dac4ed35486b218950c3dcfee27036abfa4f0207279e86b8b80f'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🧪 Phase 3 Integration Validation > should demonstrate that Phase 3 is ACTUALLY integrated
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'd7956f30361a9356772a52c45733a1f8131e9b1c543410a670abfca0a0a929f8'[39m
}

🧪 PHASE 3 INTEGRATION VALIDATION
==================================
✅ Main API exposes StoreManager: [33mtrue[39m
✅ getConversation() method available: [33mtrue[39m
✅ StoreManager initialized: [33mtrue[39m
✅ Relay configuration present: [33mtrue[39m
📁 Created synchronized store for conversation: integration-test
✅ Public API fully usable: [33mtrue[39m

🎉 PHASE 3 INTEGRATION: COMPLETE SUCCESS!
   Developers can now use:
   - await NostrUnchained.create()
   - client.getConversation(id)
   - $conversation.messages in Svelte
   - Real-time updates with Umbrel relay
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🧪 Phase 3 Integration Validation > should match the originally promised Phase 3 API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'59d00d241253c6b876d003988c0e2182dd4d1b88cda7fad87f224cea2ae2c32d'[39m
}
📁 Created synchronized store for conversation: api-validation
✅ API matches Phase 3 specifications
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🚀 Performance with Real API > should maintain sub-100ms performance through public API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'5779682c1ebf4a8601f36ff13d69c58b3a99ebca79442df3e238043e3006eead'[39m
}
📁 Created synchronized store for conversation: performance-test
🌐 Global message event: performance-test
✅ API update time: 0.19ms (<100ms requirement)
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🔄 Resource Management > should cleanup Phase 3 resources on dispose
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'070f34b744db61f01fcce3423c08ff2d639a9776e60d978834dcfe7c83a22187'[39m
}
📁 Created synchronized store for conversation: cleanup-test
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed
✅ Resource cleanup working correctly

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: ba0490ba8784cd2219781e988a407d3d6327c65ce19642f68a2005bcc851a771
   Content: "Message 1 to chat-1 - 1752951164216..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
✅ Event ACCEPTED by relay: ba0490ba8784cd2219781e988a407d3d6327c65ce19642f68a2005bcc851a771
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: chat-1
   📤 Published to chat-1: "Message 1 to chat-1 - 17529511..."

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: c45ed248f49bb0d6...

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 📊 Real-time Performance Validation > should meet real-time performance requirements under load
📊 Average update latency: 0.08ms
✅ DEMONSTRATED: Sustained real-time performance

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 What Phase 3 ACTUALLY delivers vs. promises > should honestly assess real-time capabilities

📋 HONEST ASSESSMENT OF PHASE 3 REAL-TIME CAPABILITIES:

What WORKS:
  ✅ Store reactivity and performance
  ✅ Event-driven architecture foundation
  ✅ Memory-bounded message handling
  ✅ Component-level real-time updates

What's MISSING:
  ❌ Store instance synchronization
  ❌ Real external event sources
  ❌ Cross-tab state coordination
  ❌ Network-driven real-time updates

🎯 CONCLUSION: Phase 3 provides "real-time" FOUNDATION
   but needs additional coordination for true real-time sync

 ❯ src/__tests__/phase3/real-time-updates.test.ts  (7 tests | 2 failed) 1225ms
   ❯ src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
     → expected 1 to be greater than 1
   ❯ src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should simulate event-driven real-time updates via Event Bus
     → expected 3 to be greater than or equal to 4
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 2 to chat-2 - 1752951164664..."
   🔑 PubKey: efd09a4c31225cf3...
   ✍️ Signature: 0778e7b652343ec3...
   🆔 Event ID: fe4f06c037891eee...
📁 Created synchronized store for conversation: chat-2
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: fe4f06c037891eee2d9897d40047be099035747e15a64f740abda8cb1a8a78ee
   Content: "Message 2 to chat-2 - 1752951164664..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
✅ Event ACCEPTED by relay: fe4f06c037891eee2d9897d40047be099035747e15a64f740abda8cb1a8a78ee
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store chat-1 about new message
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: chat-2
   📤 Published to chat-2: "Message 2 to chat-2 - 17529511..."

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📤 Published test event to Umbrel relay: Phase 3 Integration Test - 1752951163787

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📥 Received from Umbrel relay: [
  [32m'OK'[39m,
  [32m'test_1752951163787_miajkim0k'[39m,
  [33mfalse[39m,
  [32m'invalid: Event invalid id'[39m
]

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: efd09a4c31225cf3...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 3 to group-discussion - 1752951164996..."
   🔑 PubKey: e3731fecc4949088...
   ✍️ Signature: ebb6d9c15f0c9578...
   🆔 Event ID: 4eeca42f1beef861...
📁 Created synchronized store for conversation: group-discussion
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 4eeca42f1beef8614113b869e2dc8072f754b8a6cc4f40262aee27240f731357
   Content: "Message 3 to group-discussion - 1752951164996..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
✅ Event ACCEPTED by relay: 4eeca42f1beef8614113b869e2dc8072f754b8a6cc4f40262aee27240f731357
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store chat-1 about new message
🔄 Message sync - would notify store relay-messages about new message
🔄 Message sync - would notify store chat-2 about new message
🌐 Global message event: group-discussion
   📤 Published to group-discussion: "Message 3 to group-discussion ..."

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📁 Created synchronized store for conversation: real-time-sync-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
🔌 Disconnected from relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

2/3: Sending "📨 Multi-test 2: 1752951163829..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: e5e6cefcb381c9ef...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'94af066a2dfec424a06e8078686c7d2ee76896d5e82bb5cae413bdf1e5542385'[39m
}
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 94af066a2dfec424...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
🔌 Disconnected from relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📝 Created REAL signed event using NostrUnchained: "📨 Multi-test 2: 1752951163829..."
   🔑 PubKey: 1e41c4fb2ee0ac45...
   ✍️ Signature: 577edffdcf24f084...
   🆔 Event ID: 020256c2241d4259...
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 020256c2241d4259e441da14d71edf3ae73df519e84225a4283fad45b998e780
   Content: "📨 Multi-test 2: 1752951163829..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
✅ Event ACCEPTED by relay: 020256c2241d4259e441da14d71edf3ae73df519e84225a4283fad45b998e780
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: multi-test
   ✅ ACCEPTED: 020256c2241d4259e441da14d71edf3ae73df519e84225a4283fad45b998e780

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/real-event-publishing.test.ts:157:21
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'd6db600fe716680bdff21d715ac6ae8a2f33cdaed7652da4c109b77a749db643'[39m
}
📁 Created synchronized store for conversation: integration-test
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: d6db600fe716680b...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📝 Created REAL signed event using NostrUnchained: "Integration test message..."
   🔑 PubKey: fdf448c65d0c5c47...
   ✍️ Signature: 837b06885aa4ebf8...
   🆔 Event ID: 48d4492a7afac3c7...
🔍 Waiting for relay connections... (currently 0)
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should handle Umbrel relay with fallbacks
🌐 Connecting to 3 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Communication Performance > should establish connection within timeout period
🌐 Connecting to 1 relays...
Umbrel relay connection time: 1.15ms
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Communication Performance > should handle connection latency appropriately
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'ea5ceeba5a9427149ece24614518817943e60d3a245ac5349a21186019132027'[39m
}
Relay latency - Avg: 0.05ms, Max: 0.10ms
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should fallback when Umbrel relay fails
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Umbrel-Specific Features > should work with local network relay characteristics
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'574a0e5e928da218f669407a531e6be62e18f1460199a55428789aa3df71d352'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Umbrel-Specific Features > should handle Umbrel relay reconnection
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Protocol Compliance > should follow Nostr protocol standards with Umbrel relay
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Protocol Compliance > should handle WebSocket protocol correctly
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Multi-Relay Scenarios > should handle mixed local and remote relays
🌐 Connecting to 3 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Multi-Relay Scenarios > should prioritize Umbrel relay when available
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 2 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'50ef459db3430e855884782be9dd4adf9a9359f1a4364a7a090c7f1e3d2cf0d5'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Network Quality Adaptation > should adapt timeouts for local network conditions
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Network Quality Adaptation > should handle network congestion gracefully
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
🔌 Disconnected from relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase2-relay.test.ts  (17 tests | 2 failed) 2136ms
   ❯ src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
     → promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
   ❯ src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
     → expected 1.7217470000032336 to be greater than 1500
stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 48d4492a7afac3c7f5bce8c6470c618c64c5362b5084cc0b7ecd13464de951ce
   Content: "Integration test message..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Event ACCEPTED by relay: 48d4492a7afac3c7f5bce8c6470c618c64c5362b5084cc0b7ecd13464de951ce
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: integration-test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
<empty line>
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Real event publishing integrates perfectly with Phase 3 stores
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

 ❯ src/__tests__/phase3/real-event-publishing.test.ts  (5 tests | 4 failed) 2328ms
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
     → expected '🔬 Relay Test 1752951163660 - Testing…' to be '🎉 REAL EVENT from NostrUnchained API…' // Object.is equality
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
     → expected '9a409eb4b2e14dea8de4b268cbad30ed3d47b…' to match /^[0-9a-f]{64}$/
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
     → Failed to create valid Nostr event
stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🔑 Demo Public Key: 0000000000000000000000000000000000000000000000000000000005d61bc1

🎯 Publishing VALID profile event to Umbrel...
📝 Profile Event Created:
  - ID: 000000000000000000000000000000000000000000000000000000000434a010
  - Kind: [33m0[39m
  - PubKey: 0000000000000000000000000000000000000000000000000000000005d61bc1
  - Content: {"name":"Phase 3 Demo User","about":"Testing nostr-unchained Phase 3 with real Umbrel relay","picture":"https://robohash.org/0000000000000000000000000000000000000000000000000000000005d61bc1.png"}
  - Signature: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000246a588e

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
✅ Connected to Umbrel relay
📤 Profile event sent to relay

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay response: [
  [32m'OK'[39m,
  [32m'000000000000000000000000000000000000000000000000000000000434a010'[39m,
  [33mfalse[39m,
  [32m'invalid: Event invalid id'[39m
]
❌ Event rejected: invalid: Event invalid id

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

3/3: Sending "📨 Multi-test 3: 1752951163830..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 1e41c4fb2ee0ac45...

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📝 Created REAL signed event using NostrUnchained: "📨 Multi-test 3: 1752951163830..."
   🔑 PubKey: e9c8757fb6b9eb5a...
   ✍️ Signature: 95ad370e5b146f57...
   🆔 Event ID: d83b376cd591c5ae...
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: d83b376cd591c5aec3b45f6b62fd006118e43c523b2632865a12bec9b7051f3c
   Content: "📨 Multi-test 3: 1752951163830..."
📤 Event sent to relay, waiting for response...

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
✅ Event ACCEPTED by relay: d83b376cd591c5aec3b45f6b62fd006118e43c523b2632865a12bec9b7051f3c
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: multi-test
   ✅ ACCEPTED: d83b376cd591c5aec3b45f6b62fd006118e43c523b2632865a12bec9b7051f3c

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📁 Created synchronized store for conversation: rapid-updates-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

📊 RESULTS SUMMARY:
   1: ✅ ACCEPTED
   2: ✅ ACCEPTED
   3: ✅ ACCEPTED

🎯 Total accepted: 3/3
✅ At least some events were accepted by Umbrel!
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'0449397d7ee5d05ad2ade9eef053b00a34eed3f52523579162a2a82e69898c8d'[39m
}
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 0449397d7ee5d05a...

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📝 Created REAL signed event using NostrUnchained: "Debug info test..."
   🔑 PubKey: ed5e1aac8903d309...
   ✍️ Signature: 89d9ddc541c4f2cd...
   🆔 Event ID: 420272265ce1e093...
📁 Created synchronized store for conversation: debug-test
🔍 Waiting for relay connections... (currently 0)
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 420272265ce1e093edf12f844c971fafa301b2c11d4920b034df0d67f064c46c
   Content: "Debug info test..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
✅ Event ACCEPTED by relay: 420272265ce1e093edf12f844c971fafa301b2c11d4920b034df0d67f064c46c
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: debug-test

🔍 DETAILED EVENT INFORMATION:
==============================
Event ID: 420272265ce1e093edf12f844c971fafa301b2c11d4920b034df0d67f064c46c
Public Key: ed5e1aac8903d3090e4c1e3f99ea3cd3196cfafc6206cfa74d724732eec8c821
Signature: 89d9ddc541c4f2cdcfd3037dd2d4a7fd9e64ddff50ab96268bb124d6bc9c14a11beeefb138be550a5dcd1b86ac6c94695655e8a8c2df63b40834e2c1c0f9c3df
Timestamp: 1752951167
Kind: 1
Tags: []
Content: "Debug info test"
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

 ❯ src/__tests__/phase3/relay-response-test.test.ts  (3 tests | 2 failed) 4132ms
   ❯ src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
     → expected '89d9ddc541c4f2cdcfd3037dd2d4a7fd9e64d…' to match /^[0-9a-f]{64}$/
stdout | unknown test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🎉 Profile event published! Check your Umbrel interface.
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000002ef61178

🎯 Publishing multiple VALID text notes...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
✅ Connected to Umbrel for bulk publishing
📝 1/5: "Hello from nostr-unchained Phase 3! 🚀"
   Event ID: 00000000000000000000000000000000000000000000000000000000170f7006

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 1 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 2/5: "This is a real Nostr event with valid signatures ✅"
   Event ID: 000000000000000000000000000000000000000000000000000000006d54229f

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 2 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 3/5: "Your Umbrel relay should show these messages 📡"
   Event ID: 000000000000000000000000000000000000000000000000000000006d9aaf21

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 3 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 4/5: "Phase 3 Store System is working perfectly! 🎯"
   Event ID: 00000000000000000000000000000000000000000000000000000000016d490a

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 4 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 5/5: "Real-time updates + Umbrel integration = Success! 🎉"
   Event ID: 0000000000000000000000000000000000000000000000000000000053e33ffc

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 5 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📊 Published 5 text notes to Umbrel
🎉 Check your Umbrel interface - you should see activity!

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together

🎯 FINAL PHASE 3 DEMONSTRATION
===============================
1️⃣ Testing store synchronization...
📁 Created synchronized store for conversation: final-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts  (7 tests | 7 failed) 14075ms
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
     → Message must have valid ID
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
     → Message must have valid ID
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
     → Message must have valid ID
stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
🔍 Connection closed. Published: [33mtrue[39m Received: [33mfalse[39m

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
📡 Connected to Umbrel relay for subscription test

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
📨 Received event 1: Debug info test
📨 Received event 2: 📨 Multi-test 3: 1752951163830
📨 Received event 3: Integration test message
📨 Received event 4: 📨 Multi-test 2: 1752951163829
📨 Received event 5: Message 3 to group-discussion - 1752951164996
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
📊 Test Summary: Received 5 events from Umbrel relay

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Store Integration with Real Events > should handle real Nostr events in store and maintain state correctly
✅ Store correctly processed real Nostr DM event
📊 Store state: {
  messageCount: [33m1[39m,
  unreadCount: [33m1[39m,
  lastActivity: [32m'2025-07-19T18:52:58.865Z'[39m
}

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Store Integration with Real Events > should maintain conversation history with mixed real and test events
✅ Store correctly handles mixed real/test events

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Performance with Real Relay Data > should maintain performance standards with real relay latency
✅ Performance maintained with rapid real-world message simulation

 ❯ src/__tests__/phase3/relay-integration.test.ts  (8 tests | 2 failed) 15408ms
   ❯ src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
     → Test timeout
   ❯ src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real-world Error Handling > should handle malformed events gracefully
     → expected 1 to be 3 // Object.is equality
stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000003a262625

🎯 Creating conversation with mentions...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
✅ Connected for conversation publishing
💬 1/4: "Starting a new conversation on Umbrel relay! 💬..."
   From: 0000000000000000...
   Tags: []

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
💬 2/4: "Hey @00000000... - this is a mention test!..."
   From: 0000000000000000...
   Tags: [["p","000000000000000000000000000000000000000000000000000000005d38ed7b"]]

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
💬 3/4: "Thanks @00000000... for the mention! This is worki..."
   From: 0000000000000000...
   Tags: [["p","000000000000000000000000000000000000000000000000000000003a262625"]]

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
💬 4/4: "Phase 3 conversation demo complete! Your Umbrel no..."
   From: 0000000000000000...
   Tags: []

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
💬 Conversation published to Umbrel!
👥 Two different users had a conversation on your relay
🎯 Your Umbrel should now show multiple events and activity!

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000000e71e3b7

🔍 Verifying events are stored in Umbrel...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
✅ Connected for verification test

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📤 Test event publish response: rejected

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
🔍 Querying relay for stored events...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📊 Relay Activity Verification > should verify events are persisted and queryable from Umbrel
📨 Found stored event: "Debug info test..."
📨 Found stored event: "📨 Multi-test 3: 1752951163830..."
📨 Found stored event: "Integration test message..."
📨 Found stored event: "📨 Multi-test 2: 1752951163829..."
📨 Found stored event: "Message 3 to group-discussion - 17529511..."
📨 Found stored event: "Message 2 to chat-2 - 1752951164664..."
📨 Found stored event: "Message 1 to chat-1 - 1752951164216..."
📨 Found stored event: "Demo message (fake event)..."
📨 Found stored event: "Hello from the integrated API!..."
📨 Found stored event: "Hello from the integrated API!..."
✅ Query complete - found 10 stored events
📊 Verification complete: 10 events found in relay storage
🎉 SUCCESS: Your Umbrel relay is storing and serving events!
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🔑 Demo Public Key: 0000000000000000000000000000000000000000000000000000000076222a32

🎉 FINAL CELEBRATION EVENT
========================
🎯 Final Event Details:
  Content Length: [33m301[39m characters
  Event ID: 00000000000000000000000000000000000000000000000000000000558bd452
  Timestamp: 2025-07-19T18:53:11.000Z

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
🚀 Publishing final celebration event...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 🎯 Final Umbrel Integration Test > should send a final celebration event to your Umbrel
❌ Celebration event rejected: invalid: Event invalid id

✅ Phase 3 Umbrel integration COMPLETE!
🔍 Check your Umbrel interface at ws://umbrel.local:4848
📊 You should now see real Nostr activity!
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase3/umbrel-real-events.test.ts  (5 tests | 2 failed) 28242ms
   ❯ src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
     → Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   ❯ src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
     → Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848


⎯⎯⎯⎯⎯⎯ Failed Tests 31 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
 FAIL  src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/31]⎯

 FAIL  src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
AssertionError: expected 'temporary' to be 'nip07' // Object.is equality

- Expected
+ Received

- nip07
+ temporary

 ❯ src/__tests__/nostr-unchained.test.ts:92:42
     90|       
     91|       expect(instance.signer).toBeDefined();
     92|       expect(instance.signer!.info.type).toBe('nip07');
       |                                          ^
     93|       expect(instance.signer!.info.capabilities.supportsNip07).toBe(tr…
     94|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/31]⎯

 FAIL  src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
AssertionError: expected 'temporary' to be 'nip07' // Object.is equality

- Expected
+ Received

- nip07
+ temporary

 ❯ src/__tests__/nostr-unchained.test.ts:150:31
    148|       
    149|       expect(signerInfo).toBeDefined();
    150|       expect(signerInfo.type).toBe('nip07');
       |                               ^
    151|       expect(signerInfo.capabilities).toBeDefined();
    152|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/31]⎯

 FAIL  src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
AssertionError: promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
 ❯ src/__tests__/phase2-relay.test.ts:129:7
    127|           timeout: 3000, // Short timeout
    128|         })
    129|       ).rejects.toThrow();
       |       ^
    130|     });
    131| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/31]⎯

 FAIL  src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
AssertionError: expected 1.7217470000032336 to be greater than 1500
 ❯ src/__tests__/phase2-relay.test.ts:172:27
    170|         
    171|         // Should have attempted retries (minimum time with retries)
    172|         expect(totalTime).toBeGreaterThan(1500); // At least 2 retry a…
       |                           ^
    173|         expect(totalTime).toBeLessThan(8000); // But not too long
    174|         

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/31]⎯

 FAIL  src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ StoreManager.sendMessage src/stores/store-manager.ts:102:19
 ❯ NostrUnchainedImpl.sendMessage src/core/nostr-unchained-impl.ts:76:12
 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts:98:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/31]⎯

 FAIL  src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ StoreManager.sendMessage src/stores/store-manager.ts:102:19
 ❯ NostrUnchainedImpl.sendMessage src/core/nostr-unchained-impl.ts:76:12
 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts:133:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/31]⎯

 FAIL  src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
AssertionError: expected 0 to be greater than 0
 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts:150:38
    148|       const status = client.storeManager!.getConnectionStatus();
    149|       
    150|       expect(status.connectedRelays).toBeGreaterThan(0);
       |                                      ^
    151|       console.log(`🌐 Connected to ${status.connectedRelays} relay(s)`)…
    152|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/31]⎯

 FAIL  src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
AssertionError: promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
 ❯ src/__tests__/phase2-integration.test.ts:113:7
    111|           timeout: 2000, // Short timeout to fail fast
    112|         })
    113|       ).rejects.toThrow();
       |       ^
    114|     });
    115| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/31]⎯

 FAIL  src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ StoreManager.sendMessage src/stores/store-manager.ts:102:19
 ❯ NostrUnchainedImpl.sendMessage src/core/nostr-unchained-impl.ts:76:12
 ❯ src/__tests__/phase3/relay-response-test.test.ts:40:23

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/31]⎯

 FAIL  src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
AssertionError: expected '89d9ddc541c4f2cdcfd3037dd2d4a7fd9e64d…' to match /^[0-9a-f]{64}$/
 ❯ src/__tests__/phase3/relay-response-test.test.ts:129:30
    127|       expect(testEvent!.id).toMatch(/^[0-9a-f]{64}$/);
    128|       expect(testEvent!.pubkey).toMatch(/^[0-9a-f]{64}$/);
    129|       expect(testEvent!.sig).toMatch(/^[0-9a-f]{64}$/);
       |                              ^
    130|       expect(testEvent!.kind).toBe(1);
    131|       expect(testEvent!.created_at).toBeTypeOf('number');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/31]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
AssertionError: expected '🔬 Relay Test 1752951163660 - Testing…' to be '🎉 REAL EVENT from NostrUnchained API…' // Object.is equality

- Expected
+ Received

- 🎉 REAL EVENT from NostrUnchained API! 1752951163570
+ 🔬 Relay Test 1752951163660 - Testing acceptance

 ❯ src/__tests__/phase3/real-event-publishing.test.ts:40:39
     38|       
     39|       expect(publishedEvent).toBeDefined();
     40|       expect(publishedEvent!.content).toBe(messageContent);
       |                                       ^
     41|       
     42|              // Verify it's a real event, not a fake one

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/31]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:94:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/31]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
AssertionError: expected '9a409eb4b2e14dea8de4b268cbad30ed3d47b…' to match /^[0-9a-f]{64}$/
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:140:28
    138|              publishedEvents.forEach((event, i) => {
    139|          expect(event.pubkey).toMatch(/^[0-9a-f]{64}$/);
    140|          expect(event.sig).toMatch(/^[0-9a-f]{64}$/); // Schnorr signa…
       |                            ^
    141|          
    142|          // Each event should have unique ID and timestamp
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:138:30

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/31]⎯

 FAIL  src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
Error: Failed to create valid Nostr event
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:357:13
    355|     } catch (error) {
    356|       console.error('❌ Failed to create event with NostrUnchained sign…
    357|       throw new Error('Failed to create valid Nostr event');
       |             ^
    358|     }
    359|   }
 ❯ StoreManager.sendMessage src/stores/store-manager.ts:102:19
 ❯ NostrUnchainedImpl.sendMessage src/core/nostr-unchained-impl.ts:76:12
 ❯ src/__tests__/phase3/real-event-publishing.test.ts:157:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/31]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
StoreError: Message must have valid ID
 ❯ DMConversationStore.addMessage src/stores/dm-conversation.ts:118:13
    116| 
    117|     if (!message?.id) {
    118|       throw new StoreError('Message must have valid ID', 'INVALID_MESS…
       |             ^
    119|     }
    120| 
 ❯ StoreManager.addMessage src/stores/store-manager.ts:144:17
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:82:26

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'INVALID_MESSAGE', conversationId: 'real-time-sync-demo' }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/31]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
StoreError: Message must have valid ID
 ❯ DMConversationStore.addMessage src/stores/dm-conversation.ts:118:13
    116| 
    117|     if (!message?.id) {
    118|       throw new StoreError('Message must have valid ID', 'INVALID_MESS…
       |             ^
    119|     }
    120| 
 ❯ StoreManager.addMessage src/stores/store-manager.ts:144:17
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:133:28

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'INVALID_MESSAGE', conversationId: 'rapid-updates-demo' }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/31]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:163:34
    161|     it('should connect to Umbrel relay and publish actual events', asy…
    162|       // Test relay connection
    163|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    164|       
    165|       if (!connectionOk) {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/31]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:211:34
    209| 
    210|     it('should handle multiple events to Umbrel relay in rapid success…
    211|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    212|       if (!connectionOk) {
    213|         console.warn('⚠️ Skipping - Umbrel relay not available');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/31]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:266:34
    264| 
    265|     it('should receive events from relay and update stores in real-tim…
    266|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    267|       if (!connectionOk) {
    268|         console.warn('⚠️ Skipping - Umbrel relay not available');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/31]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
TypeError: testUmbrelConnection is not a function
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:313:34
    311|     
    312|     it('should maintain performance with many stores and real relay pu…
    313|       const connectionOk = await testUmbrelConnection(UMBREL_RELAY);
       |                                  ^
    314|       
    315|       // Create multiple conversation stores

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/31]⎯

 FAIL  src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
StoreError: Message must have valid ID
 ❯ DMConversationStore.addMessage src/stores/dm-conversation.ts:118:13
    116| 
    117|     if (!message?.id) {
    118|       throw new StoreError('Message must have valid ID', 'INVALID_MESS…
       |             ^
    119|     }
    120| 
 ❯ StoreManager.addMessage src/stores/store-manager.ts:144:17
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:386:26

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'INVALID_MESSAGE', conversationId: 'final-demo' }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/31]⎯

 FAIL  src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Automatic Subscription Cleanup
AssertionError: expected 1 to be +0 // Object.is equality

- Expected
+ Received

- 0
+ 1

 ❯ src/__tests__/phase3/phase3-scope-validation.test.ts:72:47
     70|       
     71|       await store.dispose();
     72|       expect(store.metrics.subscriptionCount).toBe(0);
       |                                               ^
     73|       
     74|       console.log('✅ DELIVERED: Memory leak prevention works');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/31]⎯

 FAIL  src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
AssertionError: expected 1 to be greater than 1
 ❯ src/__tests__/phase3/real-time-updates.test.ts:71:36
     69|       
     70|       // But each store DOES update in real-time internally
     71|       expect(store1Updates.length).toBeGreaterThan(1); // Initial + up…
       |                                    ^
     72|       expect(store2Updates.length).toBe(1); // Only initial
     73|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/31]⎯

 FAIL  src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should simulate event-driven real-time updates via Event Bus
AssertionError: expected 3 to be greater than or equal to 4
 ❯ src/__tests__/phase3/real-time-updates.test.ts:110:30
    108|       
    109|       // Should have multiple updates (initial + 3 messages)
    110|       expect(updates.length).toBeGreaterThanOrEqual(4);
       |                              ^
    111|       
    112|       // Verify chronological updates

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/31]⎯

 FAIL  src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
Error: Test timeout
 ❯ Timeout._onTimeout src/__tests__/phase3/relay-integration.test.ts:120:18
    118|         const timeout = setTimeout(() => {
    119|           ws.close();
    120|           reject(new Error('Test timeout'));
       |                  ^
    121|         }, 15000);
    122| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/31]⎯

 FAIL  src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real-world Error Handling > should handle malformed events gracefully
AssertionError: expected 1 to be 3 // Object.is equality

- Expected
+ Received

- 3
+ 1

 ❯ src/__tests__/phase3/relay-integration.test.ts:411:29
    409|       }
    410| 
    411|       expect(errorsHandled).toBe(malformedEvents.length);
       |                             ^
    412|       
    413|       // Store should still be functional after errors

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/31]⎯

 FAIL  src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Svelte Readable Contract > should notify subscribers when state changes
AssertionError: expected 1 to be greater than or equal to 2
 ❯ src/__tests__/phase3/dm-conversation-store.test.ts:76:29
     74| 
     75|       // Should have initial state + updated state
     76|       expect(states.length).toBeGreaterThanOrEqual(2);
       |                             ^
     77|       expect(states[states.length - 1].messages).toHaveLength(1);
     78|       expect(states[states.length - 1].messages[0].id).toBe(message.id…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/31]⎯

 FAIL  src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Message Management > should handle duplicate messages correctly
AssertionError: expected 2 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 2

 ❯ src/__tests__/phase3/dm-conversation-store.test.ts:127:33
    125|       const state = store.state;
    126|       expect(state.messages).toHaveLength(1); // Should not duplicate
    127|       expect(state.unreadCount).toBe(1); // Should not increment twice
       |                                 ^
    128|     });
    129| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/31]⎯

 FAIL  src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Lifecycle Management > should prevent operations on disposed store
AssertionError: expected [Function] to throw error including 'STORE_DISPOSED' but got 'Cannot add message to disposed store'

- Expected
+ Received

- STORE_DISPOSED
+ Cannot add message to disposed store

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/31]⎯

⎯⎯⎯⎯⎯⎯ Unhandled Errors ⎯⎯⎯⎯⎯⎯

Vitest caught 12 unhandled errors during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:81:40
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runFiles node_modules/@vitest/runner/dist/index.js:834:5
 ❯ startTests node_modules/@vitest/runner/dist/index.js:843:3

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should handle rapid real-time updates across components without performance loss". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:129:22
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:128:35
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "should connect to Umbrel relay and publish actual events". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- This was the last recorded test before the error was thrown, if error originated after test finished its execution.

⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯
Error: No signer available for event creation
 ❯ StoreManager.createTextEvent src/stores/store-manager.ts:333:13
    331|     // Use the REAL NostrUnchained signer - NO MORE FAKE SCRIPTS!
    332|     if (!this.signer) {
    333|       throw new Error('No signer available for event creation');
       |             ^
    334|     }
    335| 
 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts:387:22
 ❯ node_modules/@vitest/runner/dist/index.js:135:14
 ❯ node_modules/@vitest/runner/dist/index.js:58:26
 ❯ runTest node_modules/@vitest/runner/dist/index.js:663:17
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runSuite node_modules/@vitest/runner/dist/index.js:782:15
 ❯ runFiles node_modules/@vitest/runner/dist/index.js:834:5
 ❯ startTests node_modules/@vitest/runner/dist/index.js:843:3

This error originated in "src/__tests__/phase3/complete-phase3-demo.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 Test Files  12 failed (12)
      Tests  31 failed | 104 passed (135)
     Errors  12 errors
   Start at  20:52:42
   Duration  72.89s


 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
[3Jc
 RERUN  src/stores/dm-conversation.ts

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
Store 1 messages: [33m1[39m
Store 2 messages: [33m0[39m
⚠️ LIMITATION EXPOSED: Stores don't share state without proper integration

 ❯ src/__tests__/phase3/dm-conversation-store.test.ts  (28 tests | 3 failed) 76ms
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Svelte Readable Contract > should notify subscribers when state changes
     → expected 1 to be greater than or equal to 2
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Message Management > should handle duplicate messages correctly
     → expected 2 to be 1 // Object.is equality
   ❯ src/__tests__/phase3/dm-conversation-store.test.ts > DMConversationStore - Phase 3 Core Tests > Lifecycle Management > should prevent operations on disposed store
     → expected [Function] to throw error including 'STORE_DISPOSED' but got 'Cannot add message to disposed store'
stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should handle high-frequency real-time updates without performance degradation
✅ DEMONSTRATED: High-frequency updates handled efficiently

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should demonstrate WHY we need proper state synchronization

🔍 DEMONSTRATING THE REAL PROBLEM:
💬 Chat component messages: [33m1[39m
🔔 Notification component messages: [33m0[39m
💬 Chat unread count: [33m1[39m
🔔 Notification unread count: [33m0[39m

❌ PROBLEM: Different store instances don't share state!
🔧 SOLUTION NEEDED: Proper state synchronization mechanism

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should show a working solution with Event Bus coordination

🔧 DEMONSTRATING A WORKING SOLUTION:
📡 Event bus received message:added event

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🔄 Cross-Component State Synchronization (What we NEED) > should show a working solution with Event Bus coordination
✅ Event bus coordination demonstrated
💡 Next step: Implement proper store synchronization

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'7cf4700a886e4b7921dc136dc9467bfe1f08f713bdcd1f558c2cb72031bd4d16'[39m
}

🎯 TESTING REAL RELAY ACCEPTANCE...
==========================================
📝 Sending message: "🔬 Relay Test 1752951192533 - Testing acceptance"
⏳ Waiting for relay response...
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 7cf4700a886e4b79...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should expose store system through main API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'0db5bdec127a4e17442bc23130fef5fe82ff8dfa14f5274a6efc9f14540c741e'[39m
}
✅ StoreManager accessible via client.storeManager
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should provide conversation stores via getConversation()
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'504280ed7ff3700d6a2b4b732888a86f72d11e8a8d1829e391c8f0342d988248'[39m
}
📁 Created synchronized store for conversation: test-chat-api
✅ client.getConversation() working correctly
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > ✅ Public API Integration > should work with Svelte $conversation reactive syntax
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'2c120555525e782fd130758ec683a768533d79a737cbfb71d691ee4ea9d7486f'[39m
}
📁 Created synchronized store for conversation: svelte-test
✅ Svelte reactive subscription working
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'f5bd118f44f7e859ae13e2d0cba3fc5ce85a2348b360c5f6f90d31d4781a9904'[39m
}

🎯 Testing real developer workflow...
1️⃣ Client created and initialized
📁 Created synchronized store for conversation: user-workflow-test
2️⃣ Conversation obtained via API
3️⃣ Subscribed to conversation updates
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: f5bd118f44f7e859...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Crypto-Enhanced Foundation Layer > should initialize with crypto support and Umbrel relay
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'34a2c379042d1b19351f74b44ef5a9b928b477d636ada2cee0a31754a9f792f8'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should connect to Umbrel relay successfully
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'f7b287f966ed7dbc1c338450446d332eb54930bce3d59a656bde4b369cb99390'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should fallback to default relays when Umbrel unavailable
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🔌 Disconnected from relay: ws://invalid.umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
❌ Relay connection error ws://invalid.umbrel.local:4848: Event { isTrusted: [36m[Getter][39m }

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'8f58988eacc4c3a2fd169081c3faa57d05fe8e3b4a9eefeb65f8e4c6dc64eeb5'[39m
}

🎯 Publishing REAL signed event...
===============================
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 8f58988eacc4c3a2...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🔌 Disconnected from relay: ws://offline.umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
❌ Relay connection error ws://offline.umbrel.local:4848: Event { isTrusted: [36m[Getter][39m }

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
<empty line>
stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should not leak memory during crypto operations
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Memory and Resource Management > should cleanup crypto resources on disposal
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Concurrent Operations > should handle multiple concurrent crypto operations
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Concurrent Operations > should handle multiple concurrent crypto operations
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should recover from crypto operation failures
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should recover from crypto operation failures
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should handle Umbrel relay disconnections gracefully
🌐 Connecting to 2 relays...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📝 Created REAL signed event using NostrUnchained: "Hello from the integrated API!..."
   🔑 PubKey: b7efe20109f87a77...
   ✍️ Signature: 4309436807328551...
   🆔 Event ID: 0f86a54e530e3cef...
🔍 Waiting for relay connections... (currently 0)
✅ Connected to relay: ws://umbrel.local:4848
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Error Recovery and Resilience > should handle Umbrel relay disconnections gracefully
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📡 Connected to Umbrel relay for publish test

 ❯ src/__tests__/phase2-integration.test.ts  (15 tests | 1 failed) 249ms
   ❯ src/__tests__/phase2-integration.test.ts > Phase 2: Foundation + Crypto Integration > Umbrel Relay Integration > should handle Umbrel relay connection errors gracefully
     → promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📥 Received from Umbrel relay: [ [32m'EOSE'[39m, [32m'phase3-test-sub'[39m ]

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Native Svelte Readable Store Contract
✅ DELIVERED: Native Svelte $conversation.messages syntax support

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Memory-bounded LRU Message History (1000 messages)
✅ DELIVERED: LRU memory management works perfectly

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Cross-Tab Sync Infrastructure (BroadcastChannel)
Cross-tab sync supported: [33mtrue[39m
✅ DELIVERED: Cross-tab sync infrastructure ready

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Performance Requirements (<100ms store updates)
✅ DELIVERED: Store update in 0.31ms (<100ms requirement)

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/relay-response-test.test.ts:40:23
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
❌ FAILED! Event was REJECTED by relay!
   Error: Error: Failed to create valid Nostr event
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'01f3e731531864d344de942d2c36366c45a8b32af2522c63b3730ebb83165f7f'[39m
}

🗨️ TESTING MULTIPLE EVENTS...
==============================

1/3: Sending "📨 Multi-test 1: 1752951192791..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 01f3e731531864d3...
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/real-event-publishing.test.ts:37:30
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'329ae99410b95666eb7946b0378d798bb34ad2bc2e9de5a05ef9af575e9afbe1'[39m
}

🔍 DEMONSTRATING API DIFFERENCES:
=================================
1️⃣ Using sendMessage() (RECOMMENDED):
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 329ae99410b95666...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should connect to Umbrel relay successfully
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'3f122df4784de0d95c38437f6033ac3aeb01ac5a0ea9c37eb9f8ed7699157750'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'ef2e1719a32fb69fc922213d0680730c87086993d9f119a82e66e5bf73cd64ec'[39m
}

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 0f86a54e530e3cef1e05b79a3dd5633af9f0a863377fdac5d3c987559fadc8fe
   Content: "Hello from the integrated API!..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
✅ Event ACCEPTED by relay: 0f86a54e530e3cef1e05b79a3dd5633af9f0a863377fdac5d3c987559fadc8fe
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: user-workflow-test
4️⃣ REAL message sent and published to relay!

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ Real Nostr Event Publishing (needs Phase 5 crypto)
🔌 Umbrel relay is reachable...
❌ CANNOT DELIVER: Real event publishing because:
    1. No Event ID calculation (SHA256 of serialized event)
    2. No Event signing (secp256k1 private key needed)
    3. No proper event serialization
    4. No NIP-01 compliance validation

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ Real Event Subscription (needs Phase 4 network layer)
❌ CANNOT DELIVER: Real relay subscription because:
   1. No WebSocket relay management (Phase 4)
   2. No NIP-01 subscription filters
   3. No event validation and parsing
   4. No relay error handling

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ❌ What Phase 3 CANNOT deliver (needs Phase 5) > ❌ DM Encryption/Decryption (needs Phase 2+ integration)
❌ CANNOT DELIVER: DM encryption because:
   1. No NIP-44 encryption integration yet
   2. No gift wrap (NIP-59) implementation
   3. No key management for conversations

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store State Management with Mock Events
🎯 CORRECTLY TESTED: Store state management

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store Integration with Event Bus
🎯 CORRECTLY TESTED: Event bus integration

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 🤔 What Phase 3 SHOULD be tested for > 🎯 Store Memory Management under Load
🎯 CORRECTLY TESTED: Memory management under load

stdout | src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > 📋 Phase 3 Honest Assessment Summary > 📊 What we ACTUALLY delivered vs. what we CLAIMED

📋 HONEST PHASE 3 ASSESSMENT:

Claimed Deliverables:
   ✅ DMConversation Store: Native Svelte Readable
   ✅ Subscription Lifecycle: Automatic cleanup
   ❌ Cross-Tab Sync: Infrastructure only (no real testing)
   ✅ Memory Management: LRU 1000 messages perfect
   ⚠️ SSR Compatibility: Not tested yet
   ✅ Performance: <100ms updates achieved

Actual Capabilities:
   Store works perfectly with mock events
   Relay connection works but cannot publish valid events
   Missing Phase 4 (Network) and Phase 5 (Event Creation) integration
   Store is ready to receive real events when other phases complete

🎯 CONCLUSION: Phase 3 store system works perfectly
   but needs Phase 4+5 for real Nostr integration

 ❯ src/__tests__/phase3/phase3-scope-validation.test.ts  (12 tests | 1 failed) 122ms
   ❯ src/__tests__/phase3/phase3-scope-validation.test.ts > Phase 3 Scope Validation - Honest Assessment > ✅ What Phase 3 SHOULD and DOES deliver > ✅ Automatic Subscription Cleanup
     → expected 1 to be +0 // Object.is equality
stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should support the developer workflow: create client → get conversation → add message
✅ Complete developer workflow successful!
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'4f2643c6e93fa04d12450dda6c3d814633e799be564079be0aa15d1cfb70ecad'[39m
}
📁 Created synchronized store for conversation: multi-chat-1
📁 Created synchronized store for conversation: multi-chat-2
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 4f2643c6e93fa04d...
🔌 Disconnected from relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/relay-response-test.test.ts:76:25
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
   ❌ REJECTED: Error: Failed to create valid Nostr event

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
📝 Created REAL signed event using NostrUnchained: "Real message via sendMessage()..."
   🔑 PubKey: 67066b11cd2d95ad...
   ✍️ Signature: cb6e2fbd505dd9f0...
   🆔 Event ID: 4ff1e8c78e783299...
📁 Created synchronized store for conversation: api-demo
🔍 Waiting for relay connections... (currently 0)

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

node:internal/modules/cjs/loader:1148
  throw err;
  ^

Error: Cannot find module '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1145:15)
    at Module._load (node:internal/modules/cjs/loader:986:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:174:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v20.16.0
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
❌ Failed to create event with NostrUnchained signer: SignerError: Failed to sign event
    at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:115:13[90m)[39m
    at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
[90m    ... 6 lines matching cause stack trace ...[39m
    at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
    at runFiles [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:834:5[90m)[39m {
  cause: Error: ENOENT: no such file or directory, unlink '/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'
  [90m    at Proxy.unlinkSync (node:fs:1884:11)[39m
      at TemporarySigner.signEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/signers/temporary-signer.ts:112:12[90m)[39m
      at StoreManager.createTextEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:342:21[90m)[39m
      at StoreManager.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:102:19[90m)[39m
      at NostrUnchainedImpl.sendMessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/nostr-unchained-impl.ts:76:12[90m)[39m
      at [90m/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/__tests__/phase3/nostr-unchained-integration.test.ts:132:7
      at runTest [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:663:11[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m
      at runSuite [90m(file:///home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:782:15[90m)[39m {
    errno: [33m-2[39m,
    code: [32m'ENOENT'[39m,
    syscall: [32m'unlink'[39m,
    path: [32m'/home/sascha-laptop/bitsperity-libs/nostr-unchained/temp-signer-event.mjs'[39m
  },
  code: [32m'SIGNER_ERROR'[39m,
  category: [32m'signer'[39m
}

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'5f5372a92d491c206adf3b084c4c73b8856b97cd69b632ad965d46efde114bdd'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🧪 Phase 3 Integration Validation > should demonstrate that Phase 3 is ACTUALLY integrated
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'505041deb2edf179d2572903c1364714c64c0de64cbcf89a0dc7b0aec563dea0'[39m
}

🧪 PHASE 3 INTEGRATION VALIDATION
==================================
✅ Main API exposes StoreManager: [33mtrue[39m
✅ getConversation() method available: [33mtrue[39m
✅ StoreManager initialized: [33mtrue[39m
✅ Relay configuration present: [33mtrue[39m
📁 Created synchronized store for conversation: integration-test
✅ Public API fully usable: [33mtrue[39m

🎉 PHASE 3 INTEGRATION: COMPLETE SUCCESS!
   Developers can now use:
   - await NostrUnchained.create()
   - client.getConversation(id)
   - $conversation.messages in Svelte
   - Real-time updates with Umbrel relay
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🧪 Phase 3 Integration Validation > should match the originally promised Phase 3 API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'48052ebe50703eb17ba65b4f067a8c1ce30781b2baf1c2d394742c7df1c45935'[39m
}
📁 Created synchronized store for conversation: api-validation
✅ API matches Phase 3 specifications
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🚀 Performance with Real API > should maintain sub-100ms performance through public API
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'd2b3d50615260a45b54e5b87997988283af6764ef24728f012984b8150831d1d'[39m
}
📁 Created synchronized store for conversation: performance-test
🌐 Global message event: performance-test
✅ API update time: 0.19ms (<100ms requirement)
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🔄 Resource Management > should cleanup Phase 3 resources on dispose
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'02478cf60c43fa3939c387161683ffda84b720cb7cbab7745936f5a6410e36b1'[39m
}
📁 Created synchronized store for conversation: cleanup-test
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed
✅ Resource cleanup working correctly

 ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts  (10 tests | 2 failed) 560ms
   ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should handle multiple conversations independently
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/nostr-unchained-integration.test.ts > 🔥 NostrUnchained + Phase 3 Store Integration > 🌐 Real-world Usage Patterns > should integrate with Umbrel relay through unified API
     → expected 0 to be greater than 0
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 4ff1e8c78e783299f0b80700e9072f6e8ecf0fe1ee12fee51f8d326472227f1c
   Content: "📨 Multi-test 1: 1752951192791..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
✅ Event ACCEPTED by relay: 4ff1e8c78e783299f0b80700e9072f6e8ecf0fe1ee12fee51f8d326472227f1c
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: api-demo
   ✅ Real pubkey: 67066b11cd2d95ad...
   ✅ Real signature: cb6e2fbd505dd9f0...
   ✅ Will be published to relay and accepted

2️⃣ Using addMessage() with fake event (DEMO ONLY):
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 67066b11cd2d95ad...

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791

 ❯ src/__tests__/nostr-unchained.test.ts  (18 tests | 2 failed) 104ms
   ❯ src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
     → expected 'temporary' to be 'nip07' // Object.is equality
   ❯ src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
     → expected 'temporary' to be 'nip07' // Object.is equality
stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize with default configuration
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize with custom configuration
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'639741d746e64566f826a445143dcc413dc74256872a2b9393ecef833d295d0f'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Basic Initialization > should initialize in <200ms
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Builder Pattern > should create instance with builder pattern
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'7d7920c41ffb2ed54eca9bdbe168b69a8fd45e8b5cec4b6f9390ef13860d59a2'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Builder Pattern > should chain builder methods fluently
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should use NIP-07 signer when available
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should fallback to temporary signer when NIP-07 not available
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Signer Management > should provide signer capabilities
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should emit initialization events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Event Bus > should provide signer information in events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should dispose resources properly
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should handle multiple dispose calls gracefully
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/nostr-unchained.test.ts > NostrUnchained Foundation Layer > Resource Management > should emit disposal events
🌐 Connecting to 4 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
📝 Created REAL signed event using NostrUnchained: "Demo message (fake event)..."
   🔑 PubKey: 89c3b8fd04b7e454...
   ✍️ Signature: 938fe8a43d70a7f3...
   🆔 Event ID: bddda155d215d155...
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: api-demo
   ❌ Fake pubkey: 89c3b8fd04b7e454...
   ❌ Fake signature: 938fe8a43d70a7f3...
   ❌ Would be rejected by relay

📋 SUMMARY:
   • Use client.sendMessage() for NEW messages
   • Use addMessage() only for INCOMING messages from relays
   • sendMessage() creates real, signed, publishable events
   • addMessage() just adds existing events to stores

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should demonstrate the difference between sendMessage() and addMessage()
   📊 Store now contains 2 messages
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'05ed658472a6638c3b74882556c7c86196b10f1a2ee1047bf21b50758cc4294b'[39m
}

🗨️ Publishing to multiple conversations...
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 05ed658472a6638c...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 1 to chat-1 - 1752951193376..."
   🔑 PubKey: 6f1cb13d6dbac5b5...
   ✍️ Signature: 5d56bc80d4486be9...
   🆔 Event ID: 38a27b868ff01299...
📁 Created synchronized store for conversation: chat-1
🔍 Waiting for relay connections... (currently 0)
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 📊 Real-time Performance Validation > should meet real-time performance requirements under load
📊 Average update latency: 0.13ms
✅ DEMONSTRATED: Sustained real-time performance

stdout | src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 What Phase 3 ACTUALLY delivers vs. promises > should honestly assess real-time capabilities

📋 HONEST ASSESSMENT OF PHASE 3 REAL-TIME CAPABILITIES:

What WORKS:
  ✅ Store reactivity and performance
  ✅ Event-driven architecture foundation
  ✅ Memory-bounded message handling
  ✅ Component-level real-time updates

What's MISSING:
  ❌ Store instance synchronization
  ❌ Real external event sources
  ❌ Cross-tab state coordination
  ❌ Network-driven real-time updates

🎯 CONCLUSION: Phase 3 provides "real-time" FOUNDATION
   but needs additional coordination for true real-time sync

 ❯ src/__tests__/phase3/real-time-updates.test.ts  (7 tests | 2 failed) 1212ms
   ❯ src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should demonstrate real-time message flow between components
     → expected 1 to be greater than 1
   ❯ src/__tests__/phase3/real-time-updates.test.ts > Phase 3 Real-time Updates - Proof of Concept > 🎯 Real-time Store Updates (What Phase 3 SHOULD deliver) > should simulate event-driven real-time updates via Event Bus
     → expected 3 to be greater than or equal to 4
stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 38a27b868ff01299fa562290103d72de7c7ad0805c51dbe22adb2433d4251d2e
   Content: "Message 1 to chat-1 - 1752951193376..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
✅ Event ACCEPTED by relay: 38a27b868ff01299fa562290103d72de7c7ad0805c51dbe22adb2433d4251d2e
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: chat-1
   📤 Published to chat-1: "Message 1 to chat-1 - 17529511..."

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📤 Published test event to Umbrel relay: Phase 3 Integration Test - 1752951192729

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
📥 Received from Umbrel relay: [
  [32m'OK'[39m,
  [32m'test_1752951192729_hcrn0tn9m'[39m,
  [33mfalse[39m,
  [32m'invalid: Event invalid id'[39m
]

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 6f1cb13d6dbac5b5...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 2 to chat-2 - 1752951193814..."
   🔑 PubKey: 7ac7f3e521f43b63...
   ✍️ Signature: ded6635769c8773c...
   🆔 Event ID: 83317217b958a0a5...
📁 Created synchronized store for conversation: chat-2
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 83317217b958a0a567f6550ffc098fde156f433bd39da680b164ac10986a95e8
   Content: "Message 2 to chat-2 - 1752951193814..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
✅ Event ACCEPTED by relay: 83317217b958a0a567f6550ffc098fde156f433bd39da680b164ac10986a95e8
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store chat-1 about new message
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: chat-2
   📤 Published to chat-2: "Message 2 to chat-2 - 17529511..."

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

2/3: Sending "📨 Multi-test 2: 1752951192792..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: a58c70d53f32f6ba...

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📝 Created REAL signed event using NostrUnchained: "📨 Multi-test 2: 1752951192792..."
   🔑 PubKey: e36b7553e79b9984...
   ✍️ Signature: ebedb116f2934d55...
   🆔 Event ID: 6062f8326d6ac351...
📁 Created synchronized store for conversation: multi-test
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 6062f8326d6ac351fdfd7d32a3d0e7844f538e89fdc7214c08d3072ae55f569d
   Content: "📨 Multi-test 2: 1752951192792..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
✅ Event ACCEPTED by relay: 6062f8326d6ac351fdfd7d32a3d0e7844f538e89fdc7214c08d3072ae55f569d
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: multi-test
   ✅ ACCEPTED: 6062f8326d6ac351fdfd7d32a3d0e7844f538e89fdc7214c08d3072ae55f569d

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 7ac7f3e521f43b63...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
📝 Created REAL signed event using NostrUnchained: "Message 3 to group-discussion - 1752951194159..."
   🔑 PubKey: 045a791949efabc1...
   ✍️ Signature: 24435211792684e9...
   🆔 Event ID: 89c4c5debedd39fa...
📁 Created synchronized store for conversation: group-discussion
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 89c4c5debedd39fa40b3d6f704faabe066288b3aef83e36b80e42baedb5553c3
   Content: "Message 3 to group-discussion - 1752951194159..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
✅ Event ACCEPTED by relay: 89c4c5debedd39fa40b3d6f704faabe066288b3aef83e36b80e42baedb5553c3
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store chat-1 about new message
🔄 Message sync - would notify store relay-messages about new message
🔄 Message sync - would notify store chat-2 about new message
🌐 Global message event: group-discussion
   📤 Published to group-discussion: "Message 3 to group-discussion ..."

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'2cb5e72302c35bd1ef4930740098847d947760e205ef200029e58a1fd459caf1'[39m
}
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 2cb5e72302c35bd1...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
📝 Created REAL signed event using NostrUnchained: "Protocol compliance test..."
   🔑 PubKey: 8bd3a6e27dba7d1b...
   ✍️ Signature: b20e9499015b1cbc...
   🆔 Event ID: 3cb9624bdb3cf5b4...
📁 Created synchronized store for conversation: validation-test
🔍 Waiting for relay connections... (currently 0)

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
📁 Created synchronized store for conversation: real-time-sync-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 3cb9624bdb3cf5b414c939b45112ae13513aa2aa75d420fdccafe104ffd43794
   Content: "Protocol compliance test..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
✅ Event ACCEPTED by relay: 3cb9624bdb3cf5b414c939b45112ae13513aa2aa75d420fdccafe104ffd43794
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: validation-test
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'6cd0e7530b386a09d025a031fc3a512caa699591992d0a6c624825433a344600'[39m
}
📁 Created synchronized store for conversation: integration-test
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: 6cd0e7530b386a09...

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EOSE

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should maintain connection stability over time
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Connection Management > should handle Umbrel relay with fallbacks
🌐 Connecting to 3 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Communication Performance > should establish connection within timeout period
🌐 Connecting to 1 relays...
Umbrel relay connection time: 1.20ms
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Relay Communication Performance > should handle connection latency appropriately
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'2c297f19f8d36cf0c113ced748d6ce788b462b6f13c499d3ca88fca4249db32f'[39m
}
Relay latency - Avg: 0.06ms, Max: 0.11ms
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should fallback when Umbrel relay fails
🌐 Connecting to 2 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Umbrel-Specific Features > should work with local network relay characteristics
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'3c6f3d33fe9d1db349f25ea965785c97a740fd8e3f96e8a8995931d64dd1ec1d'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Umbrel-Specific Features > should handle Umbrel relay reconnection
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Protocol Compliance > should follow Nostr protocol standards with Umbrel relay
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Protocol Compliance > should handle WebSocket protocol correctly
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Multi-Relay Scenarios > should handle mixed local and remote relays
🌐 Connecting to 3 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Multi-Relay Scenarios > should prioritize Umbrel relay when available
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 2 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'29d9f5eb8e915bf339370815559a11e958386c9896b6f248a722f389fdd196c2'[39m
}
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Network Quality Adaptation > should adapt timeouts for local network conditions
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Network Quality Adaptation > should handle network congestion gracefully
🌐 Connecting to 1 relays...
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
✅ Connected to relay: ws://umbrel.local:4848

stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
Failed to parse relay message: Error: EventBus is disposed
    at SimpleEventBus.on [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/core/event-bus.ts:13:13[90m)[39m
    at StoreManager.setupStoreSync [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:80:19[90m)[39m
    at StoreManager.getConversationStore [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:52:12[90m)[39m
    at StoreManager.handleIncomingEvent [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:232:24[90m)[39m
    at WebSocket.ws.onmessage [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39msrc/stores/store-manager.ts:202:20[90m)[39m
    at WebSocket.invokeTheCallbackFunction [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28[90m)[39m
    at WebSocket.<anonymous> [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/helpers/create-event-accessor.js:35:32[90m)[39m
    at innerInvokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:350:25[90m)[39m
    at invokeEventListeners [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:286:3[90m)[39m
    at WebSocketImpl._dispatch [90m(/home/sascha-laptop/bitsperity-libs/nostr-unchained/[39mnode_modules/[4mjsdom[24m/lib/jsdom/living/events/EventTarget-impl.js:233:9[90m)[39m

stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)

 ❯ src/__tests__/phase2-relay.test.ts  (17 tests | 2 failed) 2137ms
   ❯ src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should handle Umbrel relay offline gracefully
     → promise resolved "NostrUnchainedImpl{ …(6) }" instead of rejecting
   ❯ src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Error Handling and Resilience > should retry connection attempts appropriately
     → expected 1.7514899999951012 to be greater than 1500
stderr | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
<empty line>
stdout | src/__tests__/phase2-relay.test.ts > Phase 2: Umbrel Relay Integration > Integration with Crypto Module > should work with crypto operations over Umbrel relay
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EOSE
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📝 Created REAL signed event using NostrUnchained: "Integration test message..."
   🔑 PubKey: d56103dabe3d2b2f...
   ✍️ Signature: 6ab8d7af6dd340da...
   🆔 Event ID: 3abaf4d702fc845c...
🔍 Waiting for relay connections... (currently 0)

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 3abaf4d702fc845cffb2a0a9205ab6eaa282943c149ccc40242d75f2bf5c6b1a
   Content: "Integration test message..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Event ACCEPTED by relay: 3abaf4d702fc845cffb2a0a9205ab6eaa282943c149ccc40242d75f2bf5c6b1a
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: integration-test

stdout | src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🎯 Integration with Previous Phase 3 Features > should work with all Phase 3 store features
✅ Real event publishing integrates perfectly with Phase 3 stores
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

 ❯ src/__tests__/phase3/real-event-publishing.test.ts  (5 tests | 3 failed) 2604ms
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should create and publish REAL signed events to Umbrel relay
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > ✅ Real Event Creation and Publishing > should work with multiple conversations and real events
     → expected '5d56bc80d4486be9731b328611bc8daf5befd…' to match /^[0-9a-f]{64}$/
   ❯ src/__tests__/phase3/real-event-publishing.test.ts > 🚀 Real Event Publishing - Phase 3 Beyond Expectations > 🔍 Event Validation > should create events that pass Nostr protocol validation
     → expected 'b20e9499015b1cbceb28548eeae6c24f98532…' to match /^[0-9a-f]{64}$/
stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

3/3: Sending "📨 Multi-test 3: 1752951192793..."
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: e36b7553e79b9984...

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📝 Created REAL signed event using NostrUnchained: "📨 Multi-test 3: 1752951192793..."
   🔑 PubKey: 93828b2ba009fd57...
   ✍️ Signature: ee2748973cb49f5d...
   🆔 Event ID: 5184248d88fce031...
🔍 Waiting for relay connections... (currently 1)
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 5184248d88fce031038d801cb4003bfc9cf9d4646805a71993322b6da0a7c706
   Content: "📨 Multi-test 3: 1752951192793..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
✅ Event ACCEPTED by relay: 5184248d88fce031038d801cb4003bfc9cf9d4646805a71993322b6da0a7c706
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: multi-test
   ✅ ACCEPTED: 5184248d88fce031038d801cb4003bfc9cf9d4646805a71993322b6da0a7c706

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000002019c4e5

🎯 Publishing VALID profile event to Umbrel...
📝 Profile Event Created:
  - ID: 000000000000000000000000000000000000000000000000000000001ab79f0c
  - Kind: [33m0[39m
  - PubKey: 000000000000000000000000000000000000000000000000000000002019c4e5
  - Content: {"name":"Phase 3 Demo User","about":"Testing nostr-unchained Phase 3 with real Umbrel relay","picture":"https://robohash.org/000000000000000000000000000000000000000000000000000000002019c4e5.png"}
  - Signature: 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007407ad40

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
✅ Connected to Umbrel relay
📤 Profile event sent to relay

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay response: [
  [32m'OK'[39m,
  [32m'000000000000000000000000000000000000000000000000000000001ab79f0c'[39m,
  [33mfalse[39m,
  [32m'invalid: Event invalid id'[39m
]
❌ Event rejected: invalid: Event invalid id

stderr | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses
<empty line>
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should handle multiple events and show individual responses

📊 RESULTS SUMMARY:
   1: ❌ REJECTED - Error: Failed to create valid Nostr event
   2: ✅ ACCEPTED
   3: ✅ ACCEPTED

🎯 Total accepted: 2/3
✅ At least some events were accepted by Umbrel!
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
NostrUnchained: Temporary signer initialized (NIP-07 not available)
🌐 Connecting to 1 relays...
NostrUnchained: Initialization completed {
  signerType: [32m'temporary'[39m,
  pubkey: [32m'c7e269308e77758aa40316f2b68ada16ea011190ed111231f51a4476c165fd7e'[39m
}
📝 Creating REAL event using NostrUnchained signer...
   Signer type: temporary
   Signer pubkey: c7e269308e77758a...
🔌 Disconnected from relay: ws://umbrel.local:4848
📝 Created REAL signed event using NostrUnchained: "Debug info test..."
   🔑 PubKey: 960ce6b6e3864ef1...
   ✍️ Signature: d1bfbbfae324fe12...
   🆔 Event ID: 26d102e84138250b...
📁 Created synchronized store for conversation: debug-test
🔍 Waiting for relay connections... (currently 0)

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
🔍 After waiting: 1 relay connections available
📤 Publishing event to 1 relay(s)...
📤 Publishing event to 1 relays...
   Event ID: 26d102e84138250b7e58f0400993f4a297f5ee419a14934594ae6820d7b83734
   Content: "Debug info test..."
📤 Event sent to relay, waiting for response...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test

 ❯ src/__tests__/phase3/relay-response-test.test.ts  (3 tests | 2 failed) 3987ms
   ❯ src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > ✅ Relay Acceptance Testing > should show if events are ACTUALLY accepted or rejected by Umbrel
     → Failed to create valid Nostr event
   ❯ src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
     → expected 'd1bfbbfae324fe12943ec7fcceb187da1ebe0…' to match /^[0-9a-f]{64}$/
stdout | src/__tests__/phase3/relay-response-test.test.ts > 🔍 Relay Response Validation > 🔍 Debugging Information > should show detailed event information for debugging
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
✅ Event ACCEPTED by relay: 26d102e84138250b7e58f0400993f4a297f5ee419a14934594ae6820d7b83734
📤 Event publishing completed
✅ Event successfully published to relay!
🔄 Message sync - would notify store relay-messages about new message
🌐 Global message event: debug-test

🔍 DETAILED EVENT INFORMATION:
==============================
Event ID: 26d102e84138250b7e58f0400993f4a297f5ee419a14934594ae6820d7b83734
Public Key: 960ce6b6e3864ef13488580a75aaa53282107da25e6a04f6d49e09401936c002
Signature: d1bfbbfae324fe12943ec7fcceb187da1ebe0e4f0d2528cce03ac0b4652389a07ef7571dd6f05b1d0afadb9a49251b12fe44bc4fc6e4dd640c240af5f20ebda3
Timestamp: 1752951196
Kind: 1
Tags: []
Content: "Debug info test"
🗑️ Disposing Store Manager...
✅ Store Manager disposed
NostrUnchained: Disposal completed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
📁 Created synchronized store for conversation: rapid-updates-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish a VALID profile event that appears in Umbrel interface
🎉 Profile event published! Check your Umbrel interface.
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000005e632aee

🎯 Publishing multiple VALID text notes...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
✅ Connected to Umbrel for bulk publishing
📝 1/5: "Hello from nostr-unchained Phase 3! 🚀"
   Event ID: 0000000000000000000000000000000000000000000000000000000077594e9b

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 1 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 2/5: "This is a real Nostr event with valid signatures ✅"
   Event ID: 000000000000000000000000000000000000000000000000000000000a527de1

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 2 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 3/5: "Your Umbrel relay should show these messages 📡"
   Event ID: 0000000000000000000000000000000000000000000000000000000047a82a60

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 3 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 4/5: "Phase 3 Store System is working perfectly! 🎯"
   Event ID: 000000000000000000000000000000000000000000000000000000007796398a

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 4 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
📝 5/5: "Real-time updates + Umbrel integration = Success! 🎉"
   Event ID: 00000000000000000000000000000000000000000000000000000000405ed0e5

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
❌ Message 5 rejected: invalid: Event invalid id

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should publish multiple VALID text notes that show up in Umbrel
🗑️ Disposing Store Manager...
✅ Store Manager disposed

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🌐 Connecting to 1 relays...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
✅ Connected to relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📁 Created synchronized store for conversation: relay-messages
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎉 REAL VALID EVENT FROM PHASE 3! 🎉

This is a ge
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🚀 Phase 3 Test #1: Hello Umbrel!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m ✅ Phase 3 Test #2: Store synchronization works!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🎯 Phase 3 Test #3: Real-time updates implemented!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📡 Phase 3 Test #4: Relay integration successful!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🌐 Phase 3 Test #5: Your Umbrel is now on Nostr!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 1
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message to chat 2
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951051559
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951051781
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951052270
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951052598
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951051561
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 🔬 Relay Test 1752951163660 - Testing acceptance
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Demo message (fake event)
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951164216
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951164664
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951164996
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951163829
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951163830
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Hello from the integrated API!
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 1: 1752951192791
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 1 to chat-1 - 1752951193376
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 2 to chat-2 - 1752951193814
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 2: 1752951192792
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Message 3 to group-discussion - 1752951194159
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Protocol compliance test

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Integration test message
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m 📨 Multi-test 3: 1752951192793
📡 Relay message from ws://umbrel.local:4848: EVENT
📨 Incoming event from relay: [33m1[39m Debug info test
📡 Relay message from ws://umbrel.local:4848: EOSE

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📊 Published 5 text notes to Umbrel
🎉 Check your Umbrel interface - you should see activity!

stdout | src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together

🎯 FINAL PHASE 3 DEMONSTRATION
===============================
1️⃣ Testing store synchronization...
📁 Created synchronized store for conversation: final-demo
🗑️ Disposing Store Manager...
✅ Store Manager disposed

 ❯ src/__tests__/phase3/complete-phase3-demo.test.ts  (7 tests | 7 failed) 14046ms
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should synchronize state between multiple components using same conversation
     → Message must have valid ID
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > ✅ Real-time Store Synchronization (Fixed!) > should handle rapid real-time updates across components without performance loss
     → Message must have valid ID
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should connect to Umbrel relay and publish actual events
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should handle multiple events to Umbrel relay in rapid succession
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🌐 Umbrel Relay Integration (The Real Deal!) > should receive events from relay and update stores in real-time
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 📊 Performance Under Real-world Load > should maintain performance with many stores and real relay publishing
     → testUmbrelConnection is not a function
   ❯ src/__tests__/phase3/complete-phase3-demo.test.ts > 🎯 Phase 3 COMPLETE - Real-time Stores + Umbrel Events > 🎯 Complete Phase 3 Validation > should demonstrate ALL Phase 3 capabilities working together
     → Message must have valid ID
stdout | unknown test
🔌 Disconnected from relay: ws://umbrel.local:4848

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
🔍 Connection closed. Published: [33mtrue[39m Received: [33mfalse[39m

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
📡 Connected to Umbrel relay for subscription test

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should subscribe to real relay messages and add them to store
📨 Received event 1: Debug info test
📨 Received event 2: 📨 Multi-test 3: 1752951192793
📨 Received event 3: Integration test message
📨 Received event 4: Protocol compliance test
📨 Received event 5: Message 3 to group-discussion - 1752951194159
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
✅ Added message to store successfully
📊 Test Summary: Received 5 events from Umbrel relay

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Store Integration with Real Events > should handle real Nostr events in store and maintain state correctly
✅ Store correctly processed real Nostr DM event
📊 Store state: {
  messageCount: [33m1[39m,
  unreadCount: [33m1[39m,
  lastActivity: [32m'2025-07-19T18:53:27.810Z'[39m
}

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Store Integration with Real Events > should maintain conversation history with mixed real and test events
✅ Store correctly handles mixed real/test events

stdout | src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Performance with Real Relay Data > should maintain performance standards with real relay latency
✅ Performance maintained with rapid real-world message simulation

 ❯ src/__tests__/phase3/relay-integration.test.ts  (8 tests | 2 failed) 15476ms
   ❯ src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real Event Publishing and Subscription > should publish a text note to Umbrel relay and verify it appears
     → Test timeout
   ❯ src/__tests__/phase3/relay-integration.test.ts > Phase 3 Real Relay Integration - Umbrel Tests > Real-world Error Handling > should handle malformed events gracefully
     → expected 1 to be 3 // Object.is equality
stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
🔑 Demo Public Key: 000000000000000000000000000000000000000000000000000000001d4bd04c

🎯 Creating conversation with mentions...

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
✅ Connected for conversation publishing
💬 1/4: "Starting a new conversation on Umbrel relay! 💬..."
   From: 0000000000000000...
   Tags: []

stdout | src/__tests__/phase3/umbrel-real-events.test.ts > 🌐 Umbrel Relay - REAL Valid Events > 📝 Valid Event Publishing > should create a conversation with mentions that appears in Umbrel
📡 Conversation event response: OK

